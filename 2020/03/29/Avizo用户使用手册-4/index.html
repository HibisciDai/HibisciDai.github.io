<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Avizo用户使用手册-4"><meta name="keywords" content="AvizoUsersGuide,用户使用手册"><meta name="author" content="HibisciDai"><meta name="copyright" content="HibisciDai"><title>Avizo用户使用手册-4 | HibisciDai</title><link rel="shortcut icon" href="/img/avatar.png"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="manifest" href="/manifest.json"><link rel="manifest" href="/manifest.json"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '6.1.0'
} </script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="HibisciDai" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-4"><span class="toc-number">1.</span> <span class="toc-text">Chapter 4</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E6%95%99%E7%A8%8B%EF%BC%9A%E9%AB%98%E7%BA%A7%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E3%80%81%E5%88%86%E5%89%B2%E5%92%8C%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">第4章 教程：高级图像处理、分割和分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8%E9%AB%98%E7%BA%A7%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E5%92%8C%E5%AE%9A%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">2.1.</span> <span class="toc-text">4.1 开始使用高级图像处理和定量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E5%A4%84%E7%90%86%E5%9B%BE%E5%83%8F"><span class="toc-number">2.1.1.</span> <span class="toc-text">4.1.1 处理图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E8%A7%A3%E9%87%8A%E4%B8%BA3D%E5%9B%BE%E5%83%8F%E6%88%962D%E5%9B%BE%E5%83%8F%E5%A0%86%E6%A0%88"><span class="toc-number">2.1.2.</span> <span class="toc-text">4.1.2 解释为3D图像或2D图像堆栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-%E8%8E%B7%E5%8F%96%E6%9B%B4%E5%A4%9A%E5%B8%AE%E5%8A%A9"><span class="toc-number">2.1.3.</span> <span class="toc-text">4.1.3 获取更多帮助</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-4-%E4%BA%8C%E5%80%BC%E5%8C%96"><span class="toc-number">2.1.4.</span> <span class="toc-text">4.1.4 二值化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-5-%E6%9B%B4%E5%A4%9A%E5%85%B3%E4%BA%8E%E4%BA%8C%E5%80%BC%E5%9B%BE%E5%83%8F"><span class="toc-number">2.1.5.</span> <span class="toc-text">4.1.5 更多关于二值图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-6-%E6%9B%B4%E5%A4%9A%E5%85%B3%E4%BA%8E%E4%BA%8C%E5%80%BC%E5%8C%96%E7%9A%84%E6%8F%90%E7%A4%BA"><span class="toc-number">2.1.6.</span> <span class="toc-text">4.1.6 更多关于二值化的提示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-7-%E5%88%86%E7%A6%BB"><span class="toc-number">2.1.7.</span> <span class="toc-text">4.1.7 分离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-8-%E5%88%86%E6%9E%90"><span class="toc-number">2.1.8.</span> <span class="toc-text">4.1.8 分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-9-%E4%BA%A4%E4%BA%92%E5%BC%8F%E9%80%89%E6%8B%A9"><span class="toc-number">2.1.9.</span> <span class="toc-text">4.1.9 交互式选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-10-%E5%9F%BA%E4%BA%8E%E6%B5%8B%E9%87%8F%E7%9A%84%E8%BF%87%E6%BB%A4"><span class="toc-number">2.1.10.</span> <span class="toc-text">4.1.10 基于测量的过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-11-%E4%BD%BF%E7%94%A8%E7%AD%9B%E5%AD%90%E5%AF%B9%E6%B5%8B%E9%87%8F%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB"><span class="toc-number">2.1.11.</span> <span class="toc-text">4.1.11 使用筛子对测量进行分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-12-%E6%A0%87%E7%AD%BE%E5%9B%BE%E5%83%8F"><span class="toc-number">2.1.12.</span> <span class="toc-text">4.1.12 标签图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-13-%E5%9C%A8%E7%A3%81%E7%9B%98%E4%B8%8A%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.13.</span> <span class="toc-text">4.1.13 在磁盘上处理数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-14-%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99"><span class="toc-number">2.1.14.</span> <span class="toc-text">4.1.14 脚本编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-15-%E7%BB%93%E8%AE%BA"><span class="toc-number">2.1.15.</span> <span class="toc-text">4.1.15 结论</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E7%BB%86%E8%83%9E%E5%88%86%E6%9E%90%E6%95%99%E7%A8%8B"><span class="toc-number">2.2.</span> <span class="toc-text">4.2 细胞分析教程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-0-1-%E5%8F%AF%E8%A7%86%E5%8C%96%E6%95%B0%E6%8D%AE%E5%B9%B6%E5%88%9B%E5%BB%BA%E4%BA%8C%E5%80%BC%E5%9B%BE%E5%83%8F"><span class="toc-number">2.2.1.</span> <span class="toc-text">4.2.0.1 可视化数据并创建二值图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-0-2-%E5%88%86%E7%A6%BB%E7%BB%86%E8%83%9E%E7%B0%87%E5%B9%B6%E6%A0%87%E8%AE%B0"><span class="toc-number">2.2.2.</span> <span class="toc-text">4.2.0.2 分离细胞簇并标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-0-3-%E4%BB%8E%E6%A0%87%E8%AE%B0%E5%9B%BE%E5%83%8F%E4%B8%AD%E6%8F%90%E5%8F%96%E5%AE%9A%E9%87%8F%E6%B5%8B%E9%87%8F-%E8%8E%B7%E5%8F%96%E7%BB%86%E8%83%9E%E4%BD%93%E7%9A%84%E6%95%B0%E9%87%8F%E3%80%81%E5%A4%A7%E5%B0%8F%E5%92%8C%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.2.3.</span> <span class="toc-text">4.2.0.3 从标记图像中提取定量测量 获取细胞体的数量、大小和位置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E7%A4%BA%E4%BE%8B1%EF%BC%9A%E6%B5%8B%E9%87%8F%E5%82%AC%E5%8C%96%E5%89%82"><span class="toc-number">2.3.</span> <span class="toc-text">4.3 示例1：测量催化剂</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E5%AF%B9%E8%B1%A1%E6%A3%80%E6%B5%8B%E5%92%8C%E9%81%AE%E7%BD%A9"><span class="toc-number">2.3.1.</span> <span class="toc-text">4.3.1 对象检测和遮罩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E6%9B%B4%E5%A4%9A%E5%85%B3%E4%BA%8E%E6%84%9F%E5%85%B4%E8%B6%A3%E5%8C%BA%E5%9F%9F%E5%92%8C%E9%81%AE%E7%BD%A9"><span class="toc-number">2.3.2.</span> <span class="toc-text">4.3.2 更多关于感兴趣区域和遮罩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E4%BD%BF%E7%94%A8%E8%B7%9D%E7%A6%BB%E5%9B%BE"><span class="toc-number">2.3.3.</span> <span class="toc-text">4.3.3 使用距离图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-4-%E6%9B%B4%E5%A4%9A%E5%85%B3%E4%BA%8E%E8%B7%9D%E7%A6%BB%E5%9B%BE"><span class="toc-number">2.3.4.</span> <span class="toc-text">4.3.4 更多关于距离图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-5-%E6%B5%8B%E9%87%8F%E5%88%86%E5%B8%83"><span class="toc-number">2.3.5.</span> <span class="toc-text">4.3.5 测量分布</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E7%A4%BA%E4%BE%8B2%EF%BC%9A%E5%88%86%E7%A6%BB%E3%80%81%E6%B5%8B%E9%87%8F%E5%92%8C%E9%87%8D%E5%BB%BA"><span class="toc-number">2.4.</span> <span class="toc-text">4.4 示例2：分离、测量和重建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-1-%E5%88%86%E6%B0%B4%E5%B2%AD%E7%AE%97%E6%B3%95%E7%9A%84%E5%8E%9F%E7%90%86Watershed"><span class="toc-number">2.4.1.</span> <span class="toc-text">4.4.1 分水岭算法的原理Watershed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-%E5%85%88%E5%89%8D%E5%88%86%E5%89%B2Prior-Segmentation"><span class="toc-number">2.4.2.</span> <span class="toc-text">4.4.2 先前分割Prior Segmentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-3-%E4%BD%BF%E7%94%A8%E5%88%86%E6%B0%B4%E5%B2%AD%E9%80%90%E6%AD%A5%E5%88%86%E7%A6%BB"><span class="toc-number">2.4.3.</span> <span class="toc-text">4.4.3 使用分水岭逐步分离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-4-%E5%88%86%E7%A6%BB%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="toc-number">2.4.4.</span> <span class="toc-text">4.4.4 分离故障排除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-5-%E8%BF%87%E6%BB%A4%E5%8D%95%E4%B8%AA%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.4.5.</span> <span class="toc-text">4.4.5 过滤单个对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-6-%E5%87%A0%E4%BD%95%E9%87%8D%E5%BB%BA"><span class="toc-number">2.4.6.</span> <span class="toc-text">4.4.6 几何重建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-%E7%A4%BA%E4%BE%8B3-%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90-%E6%B3%A1%E6%B2%AB%E4%B8%AD%E5%AD%94%E5%BE%84%E7%9A%84%E5%88%86%E5%B8%83"><span class="toc-number">2.5.</span> <span class="toc-text">4.5 示例3: 进一步图像分析 - 泡沫中孔径的分布</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-1-%E7%AC%AC%E4%B8%80%E6%AD%A5-%E5%AD%94%E9%9A%99%E6%A3%80%E6%B5%8B"><span class="toc-number">2.5.1.</span> <span class="toc-text">4.5.1 第一步: 孔隙检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-2-%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E5%AD%94%E9%9A%99%E5%90%8E%E5%A4%84%E7%90%86"><span class="toc-number">2.5.2.</span> <span class="toc-text">4.5.2 第二步: 孔隙后处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-3-%E7%AC%AC%E4%B8%89%E6%AD%A5-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B5%8B%E9%87%8F%E7%BB%84%E5%AE%9A%E4%B9%89-%E7%94%A8%E4%BA%8E%E7%A1%AE%E5%AE%9A%E5%AD%94%E5%BE%84%E5%88%86%E5%B8%83"><span class="toc-number">2.5.3.</span> <span class="toc-text">4.5.3 第三步: 自定义测量组定义,用于确定孔径分布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-4-%E7%AC%AC%E5%9B%9B%E6%AD%A5-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B5%8B%E9%87%8F%E5%AE%9A%E4%B9%89%E4%BB%A5%E8%AE%A1%E7%AE%97%E5%AD%94%E7%9A%84%E7%90%83%E5%BD%A2%E5%BA%A6"><span class="toc-number">2.5.4.</span> <span class="toc-text">4.5.4 第四步:自定义测量定义以计算孔的球形度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-%E7%A4%BA%E4%BE%8B4-%E8%BF%9B%E4%B8%80%E6%AD%A5%E5%9B%BE%E5%83%8F%E5%88%86%E6%9E%90-%E6%B3%A1%E6%B2%AB%E4%B8%AD%E6%9D%90%E6%96%99%E7%9A%84%E5%B9%B3%E5%9D%87%E5%8E%9A%E5%BA%A6"><span class="toc-number">2.6.</span> <span class="toc-text">4.6 示例4:进一步图像分析 - 泡沫中材料的平均厚度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-1-%E5%AD%94%E9%9A%99%E6%A3%80%E6%B5%8B"><span class="toc-number">2.6.1.</span> <span class="toc-text">4.6.1 孔隙检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-2-%E5%88%86%E7%A6%BB%E9%9D%A2%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="toc-number">2.6.2.</span> <span class="toc-text">4.6.2 分离面的检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-3-%E6%9D%90%E6%96%99%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%9B%BE"><span class="toc-number">2.6.3.</span> <span class="toc-text">4.6.3 材料的距离图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-4-%E6%9D%90%E6%96%99%E5%B9%B3%E5%9D%87%E5%8E%9A%E5%BA%A6%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="toc-number">2.6.4.</span> <span class="toc-text">4.6.4 材料平均厚度的计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7"><span class="toc-number">2.7.</span> <span class="toc-text">4.7</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/Avatar.png"></div><div class="author-info__name text-center">HibisciDai</div><div class="author-info__description text-center">HibisciDai'Blog</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">240</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">87</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">33</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://github.com/HibisciDai/hexo-theme-melody">HexoTheme-github</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://molunerfinn.com/">molunerfinn</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/banner2.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">HibisciDai</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">主页</a><a class="site-page" href="/about">关于我</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/gallery">相册</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">Avizo用户使用手册-4</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-29</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/AvizoUsersGuide/">AvizoUsersGuide</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">17.2k</span><span class="post-meta__separator">|</span><span>阅读时长: 54 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4.png" class="" title="Avizo用户使用手册-4">
<p>Avizo用户使用手册-4</p>
<span id="more"></span>
<p>[TOC]</p>
<h1 id="Chapter-4"><a href="#Chapter-4" class="headerlink" title="Chapter 4"></a>Chapter 4</h1><h1 id="第4章-教程：高级图像处理、分割和分析"><a href="#第4章-教程：高级图像处理、分割和分析" class="headerlink" title="第4章 教程：高级图像处理、分割和分析"></a>第4章 教程：高级图像处理、分割和分析</h1><p>本章的教程需要Avizo许可证(Avizo Lite Edition许可证不足以支持这些功能)。</p>
<ul>
<li>开始使用高级图像处理和定量分析 - 使用Avizo进行图像处理和分析的基础知识</li>
<li>示例：<ul>
<li>测量催化剂 - 遮罩和距离图</li>
<li>分离、测量和重建 - 分水岭分离</li>
<li>泡沫中孔径的分布 - 自定义测量</li>
<li>泡沫中材料的平均厚度 - 分离厚度</li>
<li>高级分割 - 使用分割编辑器或向导进行分水岭分割</li>
<li>更多关于图像滤波 - 减少图像噪声或伪影或增强感兴趣的特征</li>
<li>更多关于标签测量 - 管理几组测量</li>
</ul>
</li>
</ul>
<h2 id="4-1-开始使用高级图像处理和定量分析"><a href="#4-1-开始使用高级图像处理和定量分析" class="headerlink" title="4.1 开始使用高级图像处理和定量分析"></a>4.1 开始使用高级图像处理和定量分析</h2><p>在这个逐步教程中,您将学习使用Avizo进行图像处理和分析的基础知识。下面使用的示例可以轻松扩展到其他应用,并遵循典型的图像分析工作流程：</p>
<ol>
<li>图像增强</li>
<li>特征提取</li>
<li>数据测量和分析</li>
</ol>
<p>本节包含以下部分：</p>
<ul>
<li>处理灰度图像</li>
<li>3D与2D堆栈解释</li>
<li>灰度图像的二值化</li>
<li>分离</li>
<li>分析和测量</li>
<li>交互式选择</li>
<li>测量过滤器</li>
<li>筛选</li>
<li>标签图像</li>
<li>在内存中(在核心)和磁盘上(核心外)处理图像</li>
<li>脚本编写</li>
</ul>
<p>您应该熟悉Avizo的基本概念才能学习本教程。特别是,您应该能够加载文件,与3D查看器交互,以及将模块连接到数据模块。所有这些问题都在Avizo第2章 - 入门中讨论。对于Avizo的日常使用,您可能会受益于熟悉Avizo的图像滤波和分割(参见第3章 - 图像和体积可视化和处理)。</p>
<h3 id="4-1-1-处理图像"><a href="#4-1-1-处理图像" class="headerlink" title="4.1.1 处理图像"></a>4.1.1 处理图像</h3><p>首先,您需要：</p>
<ul>
<li>在Avizo中加载3D微断层扫描体积数据data/images/foam/foam.am,该文件位于AVIZO_ROOT目录中。数据对象将出现在项目视图中。</li>
<li>如果自动显示被禁用,请附加一个正交切片(Ortho Slice)模块来可视化数据。为此,右键单击绿色数据图标。在对象弹出菜单中,选择名为Display的类别条目,然后双击Ortho Slice条目(或单击Create)。您也可以使用搜索字段并键入Ortho Slice的前几个字母,然后在列表中选择该模块将自动在项目视图中创建它。</li>
<li>附加另外两个正交切片模块。在第二个正交切片的属性面板中,选择xz方向,在第三个正交切片的属性面板中选择yz方向。参见图4.1中的结果显示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.1.png" class="" title="图4.1：初始数据">
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-1-LoadData.hx将完成上述步骤。</p>
<p>改善图像质量通常是必要的,以便使用图像分析获得最佳结果。下一步说明如何在Avizo中使用常用于平滑或降噪的图像滤波器处理图像。您可以在教程第4.8节 - 更多关于图像滤波中了解更多关于图像滤波器的信息。</p>
<ul>
<li>将中值滤波(Median Filter)模块附加到数据上。(使用搜索字段并输入Median Filter的前几个字母,然后在列表中选择该模块。)</li>
<li>在中值滤波的Interpretation(解释)端口中选择3D。</li>
<li>按Apply按钮。</li>
</ul>
<p>计算完成后,结果存储在新的图像对象foam.filtered中(参见图4.2)。</p>
<ul>
<li>将三个正交切片附加到结果图像上。为此,更改每个切片属性面板中的Data。参见图4.3中的结果显示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.2.png" class="" title="图4.2：中值滤波网络">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.3.png" class="" title="图4.3：使用中值滤波去除噪声后">
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-2-ImageProcessing.hx将完成上述步骤。</p>
<h3 id="4-1-2-解释为3D图像或2D图像堆栈"><a href="#4-1-2-解释为3D图像或2D图像堆栈" class="headerlink" title="4.1.2 解释为3D图像或2D图像堆栈"></a>4.1.2 解释为3D图像或2D图像堆栈</h3><p>有时,将图像处理算法的输入数据解释为3D体积或2D平面序列可能很有用。例如,许多图像滤波器和图像处理算法可以在体积的每个XY切片上使用2D内核执行,也可以在整个体积上使用3D内核执行。在某些情况下,可能更喜欢使用2D算法,无论是出于性能考虑还是根据数据和所需结果更合适。</p>
<p>在许多Avizo模块中,解释(Interpretation)端口显示当前模块的状态(即XY平面或3D)。如果端口状态为XY平面,则表示该模块将在每个XY切片上执行。如果端口状态为3D,则表示该模块将一次在整个三维图像上执行。</p>
<p>在某些情况下,无法更改解释端口(它是灰色的),例如,当处理只能应用于XY平面时。</p>
<h3 id="4-1-3-获取更多帮助"><a href="#4-1-3-获取更多帮助" class="headerlink" title="4.1.3 获取更多帮助"></a>4.1.3 获取更多帮助</h3><p>在模块的属性面板中按问号按钮 ?  可以显示模块帮助。此帮助可能根据解释模式或模块中选择的处理类型而有所不同。</p>
<h3 id="4-1-4-二值化"><a href="#4-1-4-二值化" class="headerlink" title="4.1.4 二值化"></a>4.1.4 二值化</h3><p>二值化意味着将灰度图像转换为二值图像(即仅包含内部和外部材料的标签图像)。当灰度图像中的相关信息对应于特定的灰度级间隔时,使用阈值二值化。阈值处理是一种简单的分割方法 - Avizo中还提供了更复杂的自动、半自动或手动分割工具。可以使用交互式阈值(Interactive Thresholding)模块进行阈值二值化,该模块提示您设置级别并提供视觉反馈。</p>
<ul>
<li>将交互式阈值模块附加到过滤后的数据上。</li>
</ul>
<p>您可以交互式地修改阈值,并在2D或3D中立即获得视觉反馈。选定的像素以蓝色显示在显示的图像中。</p>
<ul>
<li>在模块的属性面板中,您可以将阈值设置为0-30的范围。</li>
<li>在Preview Type(预览类型)端口中勾选和取消勾选3D选项,以获得仅2D或3D预览(参见图4.4和图4.5)。</li>
<li>按Apply按钮启动模块。</li>
</ul>
<p>输出二值图像foam.thresholded在项目视图中生成(参见图4.6)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.4.png" class="" title="图4.4：交互式阈值属性面板">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.5.png" class="" title="图4.5：交互式阈值2D预览">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.6.png" class="" title="图4.6：交互式阈值网络">
<p>在输出二值图像中,所有像素的初始灰度值在两个边界之间的都设置为1,所有其他像素都设置为0。</p>
<p>交互式阈值模块创建了一个二值图像。对于二值图像,Avizo以蓝色显示强度为1的体素。如果将正交切片附加到结果图像,则默认选择适当的颜色图。</p>
<ul>
<li>通过切换项目视图中模块图标上的橙色可见性按钮或属性面板中模块名称旁边的按钮,隐藏交互式阈值预览。</li>
<li>将第一个正交切片连接到阈值化数据。参见图4.7中的结果显示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.7.png" class="" title="图4.7：使用正交切片显示的二值图像">
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-3-Binarization.hx将完成上述步骤。</p>
<h3 id="4-1-5-更多关于二值图像"><a href="#4-1-5-更多关于二值图像" class="headerlink" title="4.1.5 更多关于二值图像"></a>4.1.5 更多关于二值图像</h3><p>在二值图像中,所有满足某些条件的像素(这里的条件是像素强度在交互式阈值中设置的两个边界内)都设置为1(感兴趣的像素),所有其他像素都设置为0(背景)。Avizo中的二值图像没有特定类型,二值图像只是具有一个标签的标签图像(每个体素8/16/32位,值为1;外部值为0)。但是,某些Avizo模块可能明确要求二值图像作为输入数据。</p>
<h3 id="4-1-6-更多关于二值化的提示"><a href="#4-1-6-更多关于二值化的提示" class="headerlink" title="4.1.6 更多关于二值化的提示"></a>4.1.6 更多关于二值化的提示</h3><p>(本节是可选的,不需要阅读即可完成后续教程。)</p>
<p>Avizo提供了广泛的工具,用于有效的数据二值化和图像分割。在许多情况下,该过程可以自动化,可能需要结合多个步骤,有时需要用户输入。在某些情况下,可能有必要或更容易进行半自动或手动分割：特别是,Avizo分割编辑器(Segmentation Editor)专为此目的而设计(请注意,分割编辑器仅支持8位标签图像)。还要记住,改善图像采集可能比分析糟糕的图像要容易得多。</p>
<p>以下是一些可以促进自动二值化的Avizo模块：</p>
<ul>
<li>自动阈值(Auto Thresholding)自动计算阈值。您可以选择最适合您数据的标准,通常是分解(factorisation)。</li>
<li>交互式顶帽(Interactive Top-Hat)是一个强大的工具,用于分割具有非均匀背景的区域,当简单阈值处理无法捕获所需特征而不产生不需要的噪声时。顶帽变换可以看作是”局部阈值处理”。顶帽结果通常与使用逻辑操作OR Image的阈值结果结合使用。</li>
<li>滞后阈值(Hysteresis Thresholding)用于在定义安全保留区域和拒绝区域的低阈值和高阈值之间实现中间二值化。例如,您可以使用交互式阈值界面交互式选择阈值,然后使用滞后阈值。另请参阅Canny边缘检测器模块。</li>
<li>许多图像滤波器(如梯度或拉普拉斯)可用于帮助二值化,例如用于边缘检测。</li>
<li>基于测量过滤区域(如本教程后面所示)也可以是分割的强大技术。</li>
</ul>
<p>二值化后,可能需要分离一些对象,如下一节所示。</p>
<h3 id="4-1-7-分离"><a href="#4-1-7-分离" class="headerlink" title="4.1.7 分离"></a>4.1.7 分离</h3><p>在示例数据集中,泡沫中的一些孔似乎相互接触,但理想情况下,应该为了适当的分析而分离它们。当采集数据太粗糙或有噪声时,阈值处理无法避免这种类型的输出,因为考虑的对象的灰度级在整个体积中不够均匀,或者分辨率太低,无法区分一些对象的边界。您可以使用分离对象(Separate Objects)模块来分离连接的粒子。</p>
<ul>
<li>将分离对象模块附加到阈值化数据。</li>
<li>将Marker Extent(标记范围)端口值设置为1,而不是默认值4。这是一个对比度因子,用于控制标记对象要分离的种子的大小。增加此值可以合并一些标记,从而减少分离的对象数量。</li>
<li>然后按Apply按钮。foam.separate数据在项目视图中生成。</li>
<li>将第一个正交切片附加到新数据。参见图4.8中的结果显示。</li>
</ul>
<p>分离对象模块的原理是在距离图上计算分水岭线。分离对象模块是分水岭、距离图和H-Maxima的高级组合。它可以用作简单直接的分离工具,在许多情况下令人满意。但是,您可能会注意到,某些分离可能缺失或不需要,特别是对于非凸形状(也考虑3D)。有关更多详细信息和高级分离,请参见示例2：分离、测量和重建单个对象 - 泡沫中的孔隙。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.8.png" class="" title="图4.8：粒子现在已分离">
<p>Loading the project data/tutorials/image-processing-advanced/GettingStartedBasics-4-Separation.hx will complete the steps above.</p>
<h3 id="4-1-8-分析"><a href="#4-1-8-分析" class="headerlink" title="4.1.8 分析"></a>4.1.8 分析</h3><p>然后,您可以使用分析模块来获取每个分离粒子的体积、表面积、平均值、体素数等。这种对图像堆栈的分析是使用标签分析(Label Analysis)模块来提取统计和数值信息,包括对象的测量。</p>
<ul>
<li>将标签分析模块附加到分离数据。</li>
<li>在模块的专用端口中将foam.am设置为强度图像(Intensity Image)。</li>
<li>按Apply按钮。</li>
</ul>
<p>项目视图中创建了一个新的标签图像数据对象foam.label,并显示了表格面板,以电子表格样式显示结果:分析foam.Label-Analysis,也在项目视图中创建(参见图4.9和图4.10)。</p>
<p>工具栏提供了以下功能:</p>
<p>(图4.10从左到右的图标)</p>
<ul>
<li>复制表格的部分内容</li>
<li>以多种格式导出电子表格</li>
<li>按升序或降序对列进行排序</li>
<li>绘制与测量相对应的直方图(见下文)</li>
<li>进行标签搜索(见下文4.1.9节 - 交互式选择)。</li>
</ul>
<p>基本测量(如在模块的Measures端口中选择的)显示在表格面板中,如下所示(Volume3d、Area3D等)。</p>
<ul>
<li>在下方电子表格中选择Volume3d列。</li>
<li>按工具栏中的直方图按钮(参见图4.11)。</li>
</ul>
<p>打开一个窗口,显示Volume3d直方图,如图4.12所示。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.9.png" class="" title="图4.9：分析网络">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.10.png" class="" title="图4.10：分析电子表格">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.11.png" class="" title="图4.11：分析面板工具栏：直方图按钮">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.12.png" class="" title="图4.12：Volume3d直方图">
<p>在Measures端口中,basic是一组包含最常用测量的组:Volume3d、Area3d、BaryCenterX、BaryCenterY、BaryCenterZ和Mean。可以定义新的测量组,由预定义的测量组成,也可以包含用户定义的测量。要了解更多关于这个主题的信息,请参阅第4.5章 - 进一步图像分析中的专门教程。</p>
<p>注意:默认情况下,如果禁用Avizo的单位管理,结果将以”pixel”或”voxel”作为单位显示。您可以启用Avizo的单位管理以显示带单位的数据和测量。请参阅第8.2.9章 - Avizo中的单位,了解有关如何在Avizo中使用单位管理的所有详细信息。</p>
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-5-Analysis.hx将完成上述步骤。</p>
<h3 id="4-1-9-交互式选择"><a href="#4-1-9-交互式选择" class="headerlink" title="4.1.9 交互式选择"></a>4.1.9 交互式选择</h3><p>Avizo允许您将3D查看器中的图像与分析面板中的相应行链接,以便找到具有相应测量的各个对象。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.13.png" class="" title="图4.13：分析面板工具栏：标签搜索按钮">
<ul>
<li>单击分析面板工具栏中的标签搜索按钮(参见图4.13)。自动将新的正交切片附加到分离图像并显示在3D查看器中,以及一个点拖动器(参见图4.14)。</li>
<li>选择分析下表中的一个单元格。点拖动器将移动到3D视图中相应对象的位置。如果显示了一个分析测量的直方图,则会出现一条垂直线,显示所选行的位置和值,如图4.15所示。</li>
<li>在查看器窗口中,您可以使用矩形手柄移动拖动器,然后在释放按钮时,分析表将突出显示相应的对象行。要移动拖动器,您必须将查看器设置为交互模式(按ESC键)。然后将鼠标移到拖动器的一个十字线上并按下鼠标左键。拾取的十字线的颜色会改变。拖动器的移动限制在相应的平面内。</li>
<li>您还可以在3D查看器中显示的场景中用鼠标中键单击可拾取的对象,例如,在显示的切片上的特定孔上:拖动器将移动到拾取的点,相应的电子表格行也将被突出显示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.14.png" class="" title="图4.14：3D查看器中对应于第82行的点拖动器(棕色线条相交)">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.15.png" class="" title="图4.15：直方图中对应于第82行的线">
<h3 id="4-1-10-基于测量的过滤"><a href="#4-1-10-基于测量的过滤" class="headerlink" title="4.1.10 基于测量的过滤"></a>4.1.10 基于测量的过滤</h3><p>您可以过滤3D查看器中显示的粒子。例如,您可以决定仅可视化Volume3d属于指定范围的粒子。</p>
<ul>
<li>将分析过滤器(Analysis Filter)附加到foam.Label-Analysis。</li>
<li>将Image端口连接到foam.label。</li>
<li>通过在Filter端口中输入Volume3d &gt;= 30000来创建新过滤器(参见图4.16)。要在公式中插入Volume3d,您可以键入它或双击下面显示的列表中的它。</li>
<li>按Apply按钮。</li>
</ul>
<p>这将创建一个包含较少对象的新分析。</p>
<ul>
<li>您可以通过将正交切片连接到新标签图像foam.label-filtering来验证创建的对象是否较少,如图4.17所示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.16.png" class="" title="图4.16：分析过滤器模块">
<p>提示:由测量驱动的过滤可以成为数据分割的强大工具。它允许您基于例如大小、形状因子、方向或几个标准的组合来选择或消除区域。</p>
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-6-FilterAnalysis.hx将完成上述步骤。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.17.png" class="" title="图4.17：过滤结果">
<h3 id="4-1-11-使用筛子对测量进行分类"><a href="#4-1-11-使用筛子对测量进行分类" class="headerlink" title="4.1.11 使用筛子对测量进行分类"></a>4.1.11 使用筛子对测量进行分类</h3><p>您可以定义一组值范围,然后可以用于使用此分布显示直方图,或用于创建显示分类的新标签图像。</p>
<ul>
<li>将筛子过滤器(Sieve Filter)附加到foam.Label-Analysis。</li>
<li>将Data端口连接到foam.label。</li>
<li>通过将Number of values更改为4来添加一个值。</li>
<li>通过编辑或移动直方图中的相应标记来修改建议的值。您也可以按Detect按钮获取常规间隔(参见图4.18)。</li>
<li>按Apply按钮。创建了一个新的标签图像foam.Sieved。</li>
<li>使用体积渲染(Volume Rendering)模块显示标签图像,如图4.19所示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.18.png" class="" title="图4.18：筛分析模块">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.19.png" class="" title="图4.19：使用体积渲染显示的筛分析结果">
<p>加载项目data/tutorials/image-processing-advanced/GettingStartedBasics-7-SieveAnalysis.hx将完成上述步骤。</p>
<h3 id="4-1-12-标签图像"><a href="#4-1-12-标签图像" class="headerlink" title="4.1.12 标签图像"></a>4.1.12 标签图像</h3><ul>
<li>隐藏体积渲染</li>
<li>将第一个正交切片附加到标签图像foam.label。</li>
</ul>
<p>在与结果电子表格一起创建的标签图像中,每个粒子都已被识别并分配了唯一的索引。在这种情况下,标签数据存储为16位标签图像。默认情况下,使用循环颜色图显示此类图像,以使相邻的粒子更可能以不同的颜色显示,如图4.20所示。</p>
<p>在这种情况下,必须将每个体素16位的标签图像转换为每个体素8位的标签图像。</p>
<p>注意:来自分割编辑器和多阈值模块的Avizo标签图像是每个体素8位的标签图像。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.20.png" class="" title="图4.20：每个粒子都已被识别并分配了唯一的索引">
<h3 id="4-1-13-在磁盘上处理数据"><a href="#4-1-13-在磁盘上处理数据" class="headerlink" title="4.1.13 在磁盘上处理数据"></a>4.1.13 在磁盘上处理数据</h3><p>在某些情况下,您可能决定使用Visilog 6 (.im6)数据格式,以便在打开数据文件时能够”将数据保留在磁盘上”,而不是将数据完全加载到内存中。这样,一些Avizo模块可以逐片加载和处理图像数据(核心外),避免需要将完整数据加载到内存中(核心内)。这允许处理比系统上可用内存大得多的数据,但代价是处理时间。</p>
<p>默认情况下,模块输出将以与模块输入相同的方式创建。因此,为了完全在磁盘上处理数据(输入和输出),您需要在打开输入数据时选择Stay on disk。</p>
<p>除了Visilog 6格式文件外,您还可以对其他数据格式(如.lda)使用Stay on disk。您还可以将未压缩的Avizo文件、原始文件作为大磁盘数据加载。</p>
<h3 id="4-1-14-脚本编写"><a href="#4-1-14-脚本编写" class="headerlink" title="4.1.14 脚本编写"></a>4.1.14 脚本编写</h3><p>可以将完整的处理序列放入脚本中,以自动化进行常规任务的分析。有关使用Avizo进行脚本编写的详细信息,请参见第4.4章 - 示例3:分离、测量和重建。</p>
<h3 id="4-1-15-结论"><a href="#4-1-15-结论" class="headerlink" title="4.1.15 结论"></a>4.1.15 结论</h3><p>本教程向您介绍了:</p>
<ul>
<li>Avizo界面模块和帮助菜单,</li>
<li>灰度图像处理模块,</li>
<li>二值图像处理模块,</li>
<li>用于存储索引(分段)图像的标签图像,</li>
<li>3D与2D堆栈处理模块,</li>
<li>内核内与核心外处理,</li>
<li>如何计算测量分析,</li>
<li>使用过滤器来减少分段数据,</li>
<li>使用筛子来解释您的测量,</li>
<li>脚本编写。</li>
</ul>
<p>这些概念可以以无数种方式扩展以应对新的挑战。尝试将您的图像处理问题与这个简单的工作流程联系起来:</p>
<ul>
<li>图像处理使数据更容易进行二值化,</li>
<li>通过阈值处理或顶帽等工具进行二值化(有时结合两种技术),</li>
<li>标记以索引所有断开连接的对象,</li>
<li>测量所有索引对象的关键属性,</li>
<li>通过视觉检查以及过滤或筛选来分析测量数据。</li>
</ul>
<p>这个介绍突出显示了如何使用Avizo执行复杂的3D数据分割和分析,但除了此处介绍的内容外,还有许多其他处理操作和测量。</p>
<p>Avizo为您提供了这个广泛的工具包,以便您可以将适当的工具映射到面临的任何处理挑战。</p>
<h2 id="4-2-细胞分析教程"><a href="#4-2-细胞分析教程" class="headerlink" title="4.2 细胞分析教程"></a>4.2 细胞分析教程</h2><p>在生物医学成像中，有时需要测量和量化多个对象，如细胞、囊泡或斑点。本教程展示了如何利用Avizo扩展模块来执行对象的自动分割、分离聚集项目，并提取定量信息，包括它们的形状。本教程将涵盖以下主题：</p>
<ul>
<li>创建对象（细胞体）的二值分割</li>
<li>分离聚集细胞并单独标记它们</li>
<li>获取细胞的数量、大小和位置</li>
<li>测量细胞密度</li>
<li>提取细胞的形状参数</li>
<li>根据形状参数过滤标签图像，重建并将过滤后的标签图像可视化为表面模型</li>
</ul>
<h3 id="4-2-0-1-可视化数据并创建二值图像"><a href="#4-2-0-1-可视化数据并创建二值图像" class="headerlink" title="4.2.0.1 可视化数据并创建二值图像"></a>4.2.0.1 可视化数据并创建二值图像</h3><ul>
<li>加载AVIZO_ROOT目录中的data/tutorials/multicomp/cellbodies.am。</li>
<li>如果自动显示被禁用，请将Ortho Slice模块附加到cellbodies.am对象。</li>
<li>使用Slice Number端口浏览切片，或在查看器中使用交互模式。</li>
</ul>
<p>我们看到一些明亮的球状结构嵌入在黑暗背景中。这些明亮的结构是大鼠皮层神经元的细胞体（胞体）。这些神经元已用选择性荧光染料染色，并用共聚焦显微镜成像。数据由Max Planck Florida Institute的Marcel Oberlaender和Bernd Sakmann提供。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.21.png" class="" title="图4.21：用Ortho Slice可视化的大鼠皮层细胞胞体的共聚焦图像堆栈">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.22.png" class="" title="图4.22：图像堆栈的二进制分割。使用模块 Color Wash 在灰色图像上显示标签字段">
<p>第一步，我们需要将3D图像数据分割成前景（细胞体）和背景体素的二值分割。通常这是通过阈值处理完成的。然而，简单阈值的缺点是，如果选择的阈值灰度值太低，不需要的背景信号会被分配到前景。另一方面，如果阈值选择得太高，可能会错过染色较浅的细胞。我们使用一个模块来解决这个问题，该模块使用两个阈值值，一个用于检测亮区域，另一个用于将这些区域扩展到达到较低阈值。</p>
<ul>
<li>将Hysteresis Thresholding模块连接到cellbodies.am。</li>
<li>在Thresholds (Low/High)文本字段中输入70和112。单击Apply。</li>
<li>将Color Wash添加到Ortho Slice。在Color Wash中选择Fusion Method: Weighted Sum，将Data端口连接到cellbodies.binary，并将Weight Factor端口设置为0.7。</li>
</ul>
<p>使用带有Ortho Slice的Color Wash模块可以快速查看分割的内容。您可以通过移动Color Wash模块的Alpha滑块在灰度值和标签之间进行混合。在浏览切片时，我们注意到一些细胞体内部有小的未分割区域。为了填充这些孔洞，我们将使用以下操作序列：</p>
<ul>
<li>将Dilation连接到cellbodies.binary。将Size[px]设置为1，单击Apply。</li>
<li>将Fill Holes连接到cellbodies.dilated。将Interpretation设置为3D，单击Apply。</li>
<li>将Erosion连接到cellbodies.filled。将Size[px]设置为1，单击Apply。</li>
</ul>
<p>膨胀（扩大）Dilation (Grow)- 填充Filling - 腐蚀（缩小）Erosion (Shrink)的形态学操作序列对于关闭和填充不完全标记的对象很有用。如果必要，可以增加膨胀（扩大）(grow)的次数，在这种情况下，腐蚀（缩小）(shrink) 的次数也必须增加相同的数量。使用Dilation和Erosion模块中的Size[px]端口来实现这一点。</p>
<h3 id="4-2-0-2-分离细胞簇并标记"><a href="#4-2-0-2-分离细胞簇并标记" class="headerlink" title="4.2.0.2 分离细胞簇并标记"></a>4.2.0.2 分离细胞簇并标记</h3><p>我们注意到，在细胞密集排列的情况下，有些细胞被分割成一个单一的块。此外，我们无法区分单个细胞，因为它们都属于同一材料。因此，下一步我们需要分离聚集的细胞体并单独标记它们。这里我们展示如何使用距离图的分水岭变换来完成这个任务。</p>
<p>为了使分水岭变换工作，需要一个在强度域中具有”凹谷”、”山脊”和”鞍部”的图像。我们可以通过计算标签对象的反转距离图来实现这一点。在距离图中，每个体素的值表示到区域边界的最近距离。反转这样的图会产生一个图像，其中边界体素具有高强度，因此形成”山脊”，而中心体素变得越来越暗，因此构成”凹谷”。</p>
<ul>
<li>将Distance Map模块连接到cellbodies.eroded对象，在Chamfer Weights端口中启用float选项，然后单击Apply。</li>
<li>将Arithmetic附加到cellbodies.DistField对象，在Expr.文本字段中输入-A + 6.82，然后单击Apply。</li>
</ul>
<p>从最大值（根据距离变换的Info端口推断）中减去所有体素值会反转数据，最小值为零。</p>
<ul>
<li>将Hierarchical Watershed附加到Arithmetic模块的结果。在Input threshold端口中输入0.5的值，在Minimal depth端口中输入1.75的值。单击Apply。</li>
<li>为了查看结果，重新将Color Wash的Data连接端口与Hierarchical Watershed的Result.regions图标连接，将Colormap端口中的颜色图更改为labelcolors.am。</li>
</ul>
<p>找到Input Threshold和Minimal Depth的好值通常需要一些实验。使用特定阈值进行的第一次计算将需要一些时间，这取决于图像的复杂性。随后使用不同的Minimal depth值重新计算会快得多。当使用这些值时，您会注意到，随着Minimal depth的增加，越来越多的相邻细胞融合成单个区域。相反，减少Minimal depth倾向于过度分割对象。对于这个数据集，0.5（阈值）和1.8（深度）的值是一个很好的折中方案。（加载项目）</p>
<h3 id="4-2-0-3-从标记图像中提取定量测量-获取细胞体的数量、大小和位置"><a href="#4-2-0-3-从标记图像中提取定量测量-获取细胞体的数量、大小和位置" class="headerlink" title="4.2.0.3 从标记图像中提取定量测量 获取细胞体的数量、大小和位置"></a>4.2.0.3 从标记图像中提取定量测量 获取细胞体的数量、大小和位置</h3><img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.23.png" class="" title="图4.23：标记图像堆栈的分割。使用模块 Color Wash 在灰色图像上显示标签字段">
<p>分析的第一部分旨在获取细胞体的数量、大小和位置。</p>
<ul>
<li>将Material Statistics连接到Result.regions对象，将该对象的Field连接端口与cellbodies.am连接，然后单击Apply。</li>
<li>选择新创建的Result.Regions.MaterialStatistics对象，然后单击Show按钮。</li>
</ul>
<p><strong>测量细胞密度</strong></p>
<p>计算出对象的位置后，我们可以问：细胞的局部密度是多少？Point Cloud Density模块可以测量点云中元素的局部密度。但是，这需要将细胞的位置表示为Point Cloud对象的顶点。</p>
<ul>
<li>将Spreadsheet To Point Cloud模块连接到电子表格对象，然后单击Apply。</li>
<li>要可视化点云对象，请将Point Cloud View模块连接到它。在Colormap端口中配置labelcolors.am颜色图，打开plates选项，并将Sphere scale设置为-0.5。</li>
</ul>
<p>现在我们有了点云对象，我们可以计算其密度，即每单位体积有多少细胞。</p>
<ul>
<li>将Point Cloud Density模块连接到*.Cloud对象。单击Apply。</li>
<li>通过将Point Cloud View模块重新连接到*.Density对象来可视化结果点云对象。在Colormap端口中选择physics.icol，并在Color下拉菜单中选择Density [d]项。</li>
</ul>
<p>（加载项目）</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.24.png" class="" title="图4.24：细胞体的位置由球体表示，颜色表示细胞体的局部密度。">
<p><strong>绘制染色强度的直方图</strong></p>
<p>细胞中的平均染色强度分布是什么？要回答这个问题，我们使用Material Statistics模块的输出。</p>
<ul>
<li>右键单击*.MaterialStatistics对象，并从Histogram中选择。</li>
<li>在Histogram的Properties中进行以下设置：Data Channel: Mean，取消选中Plot options端口的logarithmic，Number of bins: 60。最后，按Range端口中的Reset按钮更新直方图的范围。</li>
<li>单击Apply。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.25.png" class="" title="图4.25：直方图显示细胞体的平均染色强度分布。">
<p><strong>从标记区域提取形状信息及其可视化</strong></p>
<p>虽然Material Statistics为我们提供了有关细胞的基本信息，但以下分析旨在获取对象形状的信息。Avizo扩展提供了一个强大的标签分析模块，可以为每个区域提取椭球体的参数。这些参数以及每个对象的派生测量（如伸长度、扁平度和各向异性）将被写入电子表格对象。</p>
<p>此时，建议清除Avizo项目视图（Project/Remove All Objects）并加载项目data/tutorials/multicomp/ShapeAnalysis-start.hx。本教程的其余部分假设您这样做了。当然，您也可以继续使用当前结果。在这种情况下，文本中提到的数据对象名称可能会有所不同。</p>
<ul>
<li>将Label Analysis连接到cellbodies.labeledRegions.am。</li>
<li>在Measures端口中选择Standard Shape Analysis项，然后单击Apply。</li>
<li>右键单击输出（*.Label-Analysis）对象，并选择Spreadsheet To Point Cloud条目。</li>
<li>在Spreadsheet To Point Cloud模块中，在Output端口中选中Bounding Boxes选项，将Value端口设置为EigenVal1，并在Tensor端口中选择Fill Bounding Boxes按钮。单击Apply。</li>
<li>右键单击cellbodies.labeledRegions.Cloud并选择Tensor View模块。在Tensor View中，取消选中Scale by value端口中的FA选项。设置physics.icol颜色图，范围为0..1。单击Apply。</li>
<li>为了可视化边界框，将Line Set View模块附加到cellbodies.labeledRegions.BoundingBoxes对象。</li>
</ul>
<p>（加载项目）</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.26.png" class="" title="图4.26：标准形状分析结果的可视化。使用Tensor View可视化标记区域的椭球体表示。与椭球体主轴对齐的边界框描绘了每个区域的空间范围。">
<p><strong>根据标签测量参数过滤标记区域</strong></p>
<ul>
<li>重新加载项目data/tutorials/multicomp/ShapeAnalysis-start.hx</li>
<li>将Label Analysis模块连接到cellbodies.labeledRegions.am。</li>
<li>在Measures端口中选择Standard Shape Analysis项，然后单击Apply。</li>
<li>将Analysis Filter模块连接到 X.Label-Analysis对象。</li>
<li>在Analysis Filter的Properties中，在Filter端口的expression字段中输入Volume3d &gt; 300。</li>
<li>单击Apply创建两个新的数据集，X.Analysis-Filter是仅包含符合表达式的项目的电子表格，X.label-filtering是相应的标签字段。</li>
</ul>
<p>这样，我们从原始标签字段中提取了所有大于300（立方微米）的对象。</p>
<p>在上面的分析中，结果可能会因许多项目没有完全成像而产生偏差，因为它们延伸到图像体积的外部。为了解决这个问题，我们想要移除体积中与边界框相交的所有对象。为此，我们通过另一个条件扩展我们的表达式。我们首先在表达式文本字段中输入&amp;&amp;（逻辑AND）。我们在测量列表中向下滚动以找到BorderVoxelCount项，并双击它。最后，我们在字段中输入&lt; 10，使完整的表达式现在读作Volume3D &gt; 300 &amp;&amp; BorderVoxelCount &lt; 10。提示：为了加快编写表达式的速度，您可以双击左侧测量列表中的项目。此外，要找到适当的数值，您可以用鼠标左键拖动绘图窗口中的红线。双击该线会在表达式字段的光标位置打印当前值。</p>
<p>过滤后的对象看起来如何，它们在体积内的位置在哪里？要回答这个问题，我们从过滤后的标签字段创建表面模型。</p>
<ul>
<li>右键单击cellbodies.labeledRegions.label-filtering图标，选择Generate Surface，然后单击Apply。</li>
<li>将Surface View连接到cellbodies.labeldRegions.surf对象。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.27.png" class="" title="图4.27：分析过滤器模块的用户界面。">
<p>分析过滤器模块的用户界面。该模块提供了一个文本字段，允许输入过滤器表达式。<br>可用的度量列在左侧的框中，选择后，右侧的绘图窗口中将显示度量的直方图。绘图中的红线可以沿着绘图的纵坐标拖动，相应的计数值显示在值 = 字段中。双击红线会在当前光标位置打印当前值。</p>
<p><strong>自动更新不同过滤表达式的显示</strong></p>
<p>为了快速查看不同的过滤表达式，可以配置项目以在更改过滤表达式时自动更新。</p>
<ul>
<li>在项目视图中选择Analysis Filter，并在Properties区域底部选中auto-refresh</li>
<li>在项目视图中选择Generate Surface，并在Properties区域底部选中auto-refresh</li>
</ul>
<p>现在，每次更改过滤表达式时，都会触发表面模型的重新计算。这允许您快速查看过滤设置。</p>
<p>（加载项目）</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.28.png" class="" title="图4.28：过滤后标签字段的表面重建。">
<h2 id="4-3-示例1：测量催化剂"><a href="#4-3-示例1：测量催化剂" class="headerlink" title="4.3 示例1：测量催化剂"></a>4.3 示例1：测量催化剂</h2><p>本教程演示了使用Avizo的更多技术：</p>
<ol>
<li>使用遮罩来隔离感兴趣的对象。</li>
<li>使用距离图。</li>
<li>使用图像算术和分布直方图。</li>
</ol>
<p>要学习本教程，您应该已经阅读了第一个教程章节4.1 - 开始使用高级图像处理和定量分析，并且熟悉Avizo的基本操作。</p>
<p>显示模块的可见性可以通过常规方式在Avizo中管理，方法是单击项目视图中可见的图标上的橙色方块按钮，或在属性面板中模块标题旁边的按钮。有关项目视图的详细信息，请参见第8.1.9章。</p>
<p>本示例中使用的3D图像是通过微断层扫描获得的：一个几乎球形的支撑体包含催化剂和孔隙。催化剂在图像中显示为暗色水平（低强度体素）。孔隙和背景显示为亮色水平（高强度体素）。中间的灰度水平对应于支撑体。</p>
<p>本示例的目标是获得催化剂体素与背景（外部）之间距离的分布。这里的一个困难是外部强度与孔隙内部的强度非常接近或相同，这阻止了使用简单的阈值处理来隔离外部。此外，一些孔隙与外部相连，这阻止了使用”洪水填充flood fill”方法，如分割编辑器的魔棒工具，或从标记重建模块。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.29.png" class="" title="图4.29：催化剂和孔隙的显微断层扫描图像。">
<p>注意：在本教程中，您将了解如何管理任意感兴趣区域。另一个类似问题的常见示例是从核心外部隔离岩石核心样品的孔隙空间，例如，为了计算岩石孔隙度。</p>
<p>该过程分为几个步骤/部分，描述了逐步测量工作流程：</p>
<ul>
<li>对象检测和遮罩</li>
<li>更多关于感兴趣区域和遮罩</li>
<li>使用距离图</li>
<li>更多关于距离图</li>
<li>测量分布</li>
</ul>
<h3 id="4-3-1-对象检测和遮罩"><a href="#4-3-1-对象检测和遮罩" class="headerlink" title="4.3.1 对象检测和遮罩"></a>4.3.1 对象检测和遮罩</h3><ul>
<li>首先加载AVIZO_ROOT目录中的data/tutorials/image-processing-advanced/Catalyst.am。</li>
<li>如果自动显示被禁用，请将Ortho Slice模块附加到项目视图中的Catalyst.am图像图标以显示此图像。</li>
</ul>
<p>加载项目data/tutorials/image-processing-advanced/CatalystDistribution-1-LoadData.hx将完成此教程步骤（参见图4.30）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.30.png" class="" title="图4.30：初始图像">
<p>现在，您可以开始使用本示例中用于对象检测的第一步：阈值处理，然后关闭以”填充”对象并准备遮罩。下一节将提供更多关于创建遮罩和任意感兴趣区域的可能方法的提示。</p>
<p><strong>阈值处理Thresholding</strong></p>
<ul>
<li>将Interactive Thresholding模块附加到Catalyst.am模块。</li>
</ul>
<p>要搜索适当的阈值，您可以直接更改Threshold端口。根据Preview Type端口，2D或3D预览将交互式渲染。记得通过更改Preview Slice Number和Preview Orientation端口来检查整个体积。其他Avizo模块也可能对此任务有帮助（参见第3.2节可视化3D图像）。</p>
<p>在这里，将图像阈值设置在0到225之间（参见图4.31）会得到一个二值图像，其中：</p>
<ul>
<li>强度级别 = 1 -&gt; 支撑体或催化剂（材料），</li>
<li>强度级别 = 0 -&gt; 孔隙或外部背景。</li>
</ul>
<p>应用Interactive Thresholding模块将创建一个二值图像（仅包含内部和外部材料的图像标签），如下所述：</p>
<ul>
<li>在项目视图中选择Interactive Thresholding模块，然后使用此端口的滑块手柄或文本区域将Threshold值更改为0-225范围。</li>
<li>通过拖动此端口的滑块，将Preview Slice Number端口更改为45。</li>
<li>按Apply按钮开始处理。</li>
<li>在Preview Type端口中选中3D以获得3D预览，取消选中3D以撤消此预览。</li>
<li>将当前链接到Catalyst.am的Ortho Slice附加到结果图像，方法是单击并将Ortho Slice的链接拖到Catalyst.thresholded；默认情况下将选择适当的颜色图。</li>
<li>通过单击项目视图中此模块的橙色方块来隐藏Interactive Thresholding预览。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.31.png" class="" title="图4.31：属性区域和项目视图">
<p>加载项目CatalystDistribution-2-InteractiveThresholding.hx将完成此教程步骤（参见图4.32）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.32.png" class="" title="图4.32：阈值处理后的材料二值图像">
<p><strong>形态学：闭合对象Morphological: Closing object</strong></p>
<p>为了检测对象形状，您现在可以应用形态学模块。数学形态学模块是基于形状和大小标准的变换。</p>
<p>应用于二值图像的形态学Closing模块会生成另一个二值图像，其中：</p>
<ul>
<li>对象内部的小孔被填充，</li>
<li>对象边界被平滑，</li>
<li>靠近的对象被连接。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.33.png" class="" title="图4.33：Closing模块对二值图像的效果">
<p>Closing模块实际上对二值化区域进行膨胀，然后进行腐蚀：直观地说，膨胀填充孔洞并重新连接分离的区域，然后腐蚀恢复原始外部形状。</p>
<p>以下是填充对象孔隙的步骤：</p>
<ul>
<li>将Closing模块附加到Catalyst.thresholded。</li>
<li>为了填充对象内部的任何孔洞，您必须将Size端口设置为6（结构元素的大小）。可以通过几次尝试找到这样的特定值，并通过滑动Ortho Slice检查整个体积。</li>
<li>然后按Apply按钮创建结果二值图像。</li>
<li>将已有的Ortho Slice附加到Catalyst.closing。</li>
</ul>
<p>加载项目CatalystDistribution-3-Closing.hx将完成此教程步骤（参见图4.34）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.34.png" class="" title="图4.34：Closing后的对象二值图像">
<p>注意：您可能注意到上图右侧的伪影是由于太靠近图像边缘的膨胀造成的。为了防止这种情况，对象周围的背景边框应该比闭合的大小更大。这可以通过使用图像Crop Editor轻松解决：在此示例中，您可以设置Adjust为10，然后取消选中Add模式的Replicate，并将Pixel value设置为背景强度（即0）；然后按Enlarge按钮将添加10个体素的边框。但是，在本教程中，您可以忽略此扩展步骤。</p>
<h3 id="4-3-2-更多关于感兴趣区域和遮罩"><a href="#4-3-2-更多关于感兴趣区域和遮罩" class="headerlink" title="4.3.2 更多关于感兴趣区域和遮罩"></a>4.3.2 更多关于感兴趣区域和遮罩</h3><p>通常需要或有用的是将测量或处理限制在数据的子集中。</p>
<p>如果子集是轴对齐的盒子，您可以使用以下工具：</p>
<ul>
<li>许多模块支持感兴趣区域（ROI）输入。您可以将ROI Box模块附加到数据，然后将显示或计算模块的ROI输入连接到ROI Box模块。</li>
<li>图像Crop Editor可以剪切或扩展您的数据。</li>
<li>Extract Subvolume模块将数据的一部分复制到内存中，可能会进行子采样。</li>
</ul>
<p>如果您需要任意遮罩或感兴趣区域 - 例如圆柱形ROI，您可以使用以下工具：</p>
<ul>
<li>可以使用每个二值图像弹出菜单中排序到Image Processing/Image Morphology的许多模块来创建或组合遮罩，如上所示。其他示例包括Convex Hull（逐片应用），Fill Holes，Reconstruction From Markers。</li>
<li>Volume Edit模块用于使用交互式工具（如圆柱体）修改体积。它也可以通过脚本使用。</li>
<li>Segmentation Editor有许多有用的工具，可以快速创建遮罩，如刷子、形状套索、Selection/Interpolate。</li>
</ul>
<h3 id="4-3-3-使用距离图"><a href="#4-3-3-使用距离图" class="headerlink" title="4.3.3 使用距离图"></a>4.3.3 使用距离图</h3><p>第二步是计算催化剂的距离图。下一节提供了有关距离图的更多提示。</p>
<p>将距离图算法应用于二值图像会生成一个灰度图像，其中每个体素强度表示与对象边界的最小距离（以体素为单位）。对于给定的对象距离图体素强度：</p>
<ul>
<li>强度级别 = 0 -&gt; 背景</li>
<li>强度级别 = 1 -&gt; 对象包络</li>
<li>其他低级强度 -&gt; 靠近对象包络的对象部分</li>
<li>其他高级强度 -&gt; 远离对象包络的对象部分</li>
</ul>
<p>现在，您可以按以下步骤创建此距离图：</p>
<ul>
<li>将新的Chamfer Distance Map模块附加到Catalyst.closing。</li>
<li>将Interpretation设置为3D并单击Apply。</li>
<li>将新的Ortho Slice附加到结果（Catalyst.distmap）以查看对象的距离图。</li>
</ul>
<p>加载项目CatalystDistribution-4-DistanceMap.hx将完成此教程步骤（参见图4.35）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.35.png" class="" title="图4.35：对象距离图">
<p><strong>遮罩Masking</strong></p>
<ul>
<li>将Interactive Thresholding模块应用于初始图像Catalyst.am。</li>
<li>将阈值设置在0到100之间，然后单击Apply。</li>
</ul>
<p>这会生成一个二值图像（Catalyst2.thresholded），其中：</p>
<ul>
<li>强度级别 = 1 -&gt; 催化剂，</li>
<li>强度级别 = 0 -&gt; 支撑体、孔隙或背景。</li>
</ul>
<p>加载项目CatalystDistribution-5-InteractiveThresholding.hx将完成此教程步骤（参见图4.36）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.36.png" class="" title="图4.36：催化剂二值图像">
<p>遮罩将用于计算催化剂的受限距离图。遮罩操作将灰度图像作为第一个输入，将二值图像作为第二个输入（遮罩图像），并提供一个灰度图像作为输出，其中：</p>
<ul>
<li>遮罩图像中的每个黑色体素在输出图像中设置为0，</li>
<li>遮罩图像中的每个蓝色体素在输出图像中设置为来自灰度图像的初始级别。</li>
</ul>
<p>用催化剂图像遮罩距离图图像会生成一个灰度图像，其中：</p>
<ul>
<li>每个非零强度代表催化剂的一个体素，</li>
<li>强度值等于与对象包络的距离（以体素为单位）。</li>
</ul>
<p>您可以按以下步骤创建这样的遮罩：</p>
<ul>
<li>应用Mask模块：第一个输入是Catalyst.distmap（距离图图像），第二个输入是先前获得的催化剂二值图像Catalyst2.thresholded。</li>
<li>将新的Ortho Slice附加到结果以查看对象的距离图。为了获得更好的渲染，您可以将Ortho Slice的颜色图范围映射到Catalyst.masked的全范围：在Colormap端口中将min-max设置为0…93。</li>
</ul>
<p>加载项目CatalystDistribution-6-Masking.hx将完成此教程步骤（参见图4.37）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.37.png" class="" title="图4.37：催化剂距离图">
<h3 id="4-3-4-更多关于距离图"><a href="#4-3-4-更多关于距离图" class="headerlink" title="4.3.4 更多关于距离图"></a>4.3.4 更多关于距离图</h3><p>距离图（也称为距离变换）是许多图像处理技术的强大工具。计算的距离可能是离散近似（chamfer图）以加快计算速度。Avizo提供了几种版本的距离图，您可以根据具体用途进行检查。</p>
<p>大多数可用的距离模块都可以在对象弹出菜单中的Image Processing子类别中找到：</p>
<ul>
<li>Chessboard Distance Map（2D/3D棋盘）</li>
<li>2D/3D Chamfer Distance Map（棋盘和对角线）</li>
<li>Geodesic Distance Map（基于遮罩隐藏特定部分）</li>
<li>2D/3D Closest Boundary Points</li>
<li>作为特殊情况，Propagation Distance和相关模块在Image Processing/Image Morphology组中</li>
<li>Distance Map，使用chamfer或欧几里德距离</li>
<li>Image Processing/Distance Maps/Distance Map For Skeleton。有关距离图和3D骨架化的更多详细信息，请参见第5.7章骨架化用户指南。</li>
<li>Image Processing/Distance Maps/Distance Map On Disk Data，只能在legacy LDD磁盘数据上操作。</li>
<li>Propagation Distance（浏览体素距离）在模块弹出菜单的Image Processing/Image Morphology子类别中引用。</li>
</ul>
<h3 id="4-3-5-测量分布"><a href="#4-3-5-测量分布" class="headerlink" title="4.3.5 测量分布"></a>4.3.5 测量分布</h3><p>您计算了基于体素单位测量距离的chamfer图。为了获得一致的结果，您必须考虑体素校准：将距离图像乘以体素大小将图像强度转换为公制系统（微米）。</p>
<p>Image Processing/Arithmetics Operations模块组可用于两个图像之间或图像与常数之间的操作。</p>
<p>提示：Arithmetic模块还提供了一种灵活的方式来对图像进行计算。</p>
<p>现在您可以获得距离的分布：</p>
<ul>
<li>使用Multiply By Value，将Catalyst.masked作为第一个输入（Input Image 1端口）。将Value端口设置为5（假设体素大小为5微米）。</li>
<li>单击Apply以获得Catalyst.mult作为结果。</li>
<li>通过在项目视图中选择图像图标时显示的Info端口检索最大值。</li>
<li>将Histogram模块附加到Catalyst.mult上，以计算并绘制每个灰度级i的强度为i的体素数量。每个级别的点数将以直方图的形式绘制。将Range端口设置为{3,400}，将Max Num Bins端口设置为80。取消选中Options端口中的logarithmic，然后单击Apply以显示直方图窗口。使用File菜单，您可以对直方图进行快照或将直方图数据保存为csv文件。</li>
<li>对催化剂距离图应用Histogram模块会生成一个图表，显示位于距对象包络给定距离处的催化剂体素数量。</li>
</ul>
<p>加载项目CatalystDistribution-7-Histogram.hx将完成此教程步骤（参见图4.38）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.38.png" class="" title="图4.38：距离分布">
<h2 id="4-4-示例2：分离、测量和重建"><a href="#4-4-示例2：分离、测量和重建" class="headerlink" title="4.4 示例2：分离、测量和重建"></a>4.4 示例2：分离、测量和重建</h2><p>本教程提供了有关对象分离和提取几何信息的更多详细信息：</p>
<ol>
<li>分水岭算法的原理，一种基本的图像处理工具Principle of the Watershed Algorithm, an essential tool for image processing</li>
<li>先前分割Prior Segmentation</li>
<li>使用分水岭逐步分离对象Object Separation using Watershed step-by-step</li>
<li>分离故障排除Separation Troubleshooting</li>
<li>过滤单个对象Filtering Individual Objects</li>
<li>几何重建Geometry Reconstruction</li>
</ol>
<p>要学习本教程，您应该已经阅读了第一个教程章节4.1 - 开始使用高级图像处理和定量分析，并且熟悉Avizo的基本操作。</p>
<p>本示例中使用的3D图像是使用多个泡沫切片的数据生成的。</p>
<p>示例的目的是以比入门示例更详细的方式隔离和量化这些气泡，以更好地控制结果。在许多情况下，分离对于补偿图像分辨率过低、噪声或图像中的强度变化是必不可少的。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.39.png" class="" title="图4.39：泡沫图像">
<h3 id="4-4-1-分水岭算法的原理Watershed"><a href="#4-4-1-分水岭算法的原理Watershed" class="headerlink" title="4.4.1 分水岭算法的原理Watershed"></a>4.4.1 分水岭算法的原理Watershed</h3><p>分水岭算法是一种强大的方法，在图像处理中有许多应用，例如，用于自动对象分割或分离。</p>
<p>该算法模拟从2D或3D图像中的一组标记区域进行的淹没。它根据优先级图扩展区域，直到区域到达分水岭线。这个过程可以看作是在景观中的渐进浸没。</p>
<p>该算法依赖于两个输入：</p>
<ol>
<li><p>包含标记区域的标签图像，这些区域用作淹没的种子区域。在过程结束时，将有与不同标记的标记一样多的分离对象。这些就像河流，我们想要检索其集水区。</p>
</li>
<li><p>充当景观高度场或高程图的灰度图像，控制淹没的进展，最终确定分水岭分离的位置。这些分离位于我们景观中山谷之间的山脊线上。</p>
</li>
</ol>
<p>通过仔细选择两个输入（标记和优先级图），可以实现不同的应用。</p>
<p>入门教程中用于分离泡沫孔隙的Separate Objects模块就是一个例子。它首先计算距离图（有关距离图的更多信息，请参见第4.3章 - 测量催化剂教程）。这个距离图提供了分水岭过程的优先级图输入。距离图的最大区域 - 孔隙的最内部区域 - 提供了用于分水岭的标记输入。下一节将详细描述该过程。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.40.png" class="" title="图4.40：分水岭">
<h3 id="4-4-2-先前分割Prior-Segmentation"><a href="#4-4-2-先前分割Prior-Segmentation" class="headerlink" title="4.4.2 先前分割Prior Segmentation"></a>4.4.2 先前分割Prior Segmentation</h3><p>首先，您需要对数据进行分割，以获得孔隙的二值图像。</p>
<ul>
<li>首先在Avizo中加载图像堆栈data/images/foam/foam.am，该文件位于AVIZO_ROOT目录中。</li>
<li><p>您可能想对数据进行某种噪声减少。您通常可以应用诸如Median Filter之类的滤波器，解释设置为3D；中值滤波器是一种非线性数字滤波技术，通常用于在去除噪声的同时保留边缘。这种噪声减少是一个典型的预处理步骤，用于改善后续处理（如分割或边缘检测）的结果。</p>
<p>然而，在这个例子中，您可以跳过这个阶段，直接通过阈值处理创建二值图像。</p>
</li>
<li><p>将Interactive Thresholding模块附加到项目视图中的foam.am对象。</p>
</li>
<li>使用Threshold端口滑块的光标，将低阈值和高阈值级别设置为0和38，然后单击Apply。在预览中，您可以看到图像中的分辨率和强度分布不允许您直接分割分离的孔隙：一些孔隙仍然连接，无论选择什么阈值，除非在孔隙中留下太多噪声。</li>
<li>将Ortho Slice附加到foam.thresholded以可视化结果。</li>
</ul>
<p>加载项目WatershedSeparation-1-Thresholding.hx将完成此教程步骤（参见图4.41）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.41.png" class="" title="图4.41：二值图像">
<p>通过拖动Slice Number端口的光标，您可能会注意到一些人工孔洞（例如，在切片4、5、6中），主要与灰度图像上出现的穿过孔隙的高强度环有关。将Ortho Slice附加到灰度图像，并将Mapping type设置为histogram以突出显示这些。隐藏或移除先前的Ortho Slice。</p>
<p>与其进行上游的灰度图像或甚至采集的校正，在某些情况下，更有效的方法可能是校正二值图像，例如填充孔洞。</p>
<p>可选地，建议填充要分离的对象内的孔洞，因为基于距离图的分离方法可能对这些人工孔洞敏感。</p>
<ul>
<li>您可以将Fill Holes模块附加到foam.thresholded。</li>
<li>将Interpretation设置为3D，然后单击Apply以获得foam.filled作为结果。</li>
</ul>
<h3 id="4-4-3-使用分水岭逐步分离"><a href="#4-4-3-使用分水岭逐步分离" class="headerlink" title="4.4.3 使用分水岭逐步分离"></a>4.4.3 使用分水岭逐步分离</h3><p>从二值图像开始，您现在可以进行孔隙分离。您将计算距离图，从距离图的最大区域创建标记，然后应用快速分水岭算法。</p>
<ul>
<li>将Chamfer Distance Map模块附加到二值图像对象（foam.thresholded）。</li>
<li>将Interpretation设置为3D，然后单击Apply以获得foam.distmap作为结果。</li>
<li>附加Ortho Slice以控制结果。孔隙内的每个体素都接收一个值，对应于其到黑色背景（泡沫）的距离。</li>
</ul>
<p>加载项目WatershedSeparation-2-DistanceMap.hx将完成此教程步骤（参见图4.42）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.42.png" class="" title="图4.42：Chamfer距离图">
<ul>
<li>附加H-Maxima模块。将Contrast端口保留为默认值（4），然后单击Apply。</li>
<li>将Ortho Slice附加到foam.hMaxima，并将Transparency type设置为Alpha。</li>
</ul>
<p>加载项目WatershedSeparation-3-MergedMaxima.hx将完成此教程步骤（参见图4.43）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.43.png" class="" title="图4.43：距离图的合并最大值">
<p>该模块创建一个二值图像，包含输入距离图图像的区域最大值，这些最大值在给定为参数的对比度变化范围内”合并”。由于使用距离图作为输入，结果是对象内最内部区域的集合。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.44.png" class="" title="图4.44：在图像剖面样本上显示的H-Maxima（合并最大值）原理">
<p>分水岭算法要求每个最终分离的区域有一个唯一的标签。输入图像中具有相同值的两个区域将被合并。</p>
<ul>
<li>将Labeling模块附加到foam.hMaxima，然后单击Apply。</li>
<li>将Ortho Slice附加到foam.labels，并将Transparency type设置为Alpha。</li>
</ul>
<p>加载项目WatershedSeparation-4-Markers.hx将完成此教程步骤（参见图4.45）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.45.png" class="" title="图4.45：Labeling模块创建的标记">
<p>距离图还需要反转，因为分水岭算法将朝着输入优先级图（即景观高度）的增加值扩展标记。</p>
<ul>
<li>将NOT模块应用于foam.distmap。</li>
<li>将Ortho Slice附加到foam.not。</li>
</ul>
<p>加载项目WatershedSeparation-5-ReversedDistanceMap.hx将完成此教程步骤（参见图4.46）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.46.png" class="" title="图4.46：使用Line Probe模块显示的反转距离图">
<p>现在，您可以计算分水岭分离线的图像。</p>
<ul>
<li>将Marker-Based Watershed模块附加到反转距离数据对象（foam.not）。<br>将foam.labels设置为Input Label Image，并将Type设置为Watershed。按Apply。</li>
<li>将Ortho Slice附加到结果以查看分水岭线。设置Alpha或Binary作为Transparency type，以将线叠加在灰度图像上。</li>
<li>将Ortho Slice附加到foam.am。将Colormap最小值设置为0。</li>
</ul>
<p>加载项目WatershedSeparation-6-SeparationLines.hx将完成此教程步骤（参见图4.47）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.47.png" class="" title="图4.47：分水岭分离线">
<p>要完成分离，您可以从孔隙的二值图像中减去分离线：</p>
<ul>
<li>将AND NOT Image模块应用于foam.thresholded作为第一个输入，foam.watershed作为第二个输入。</li>
<li>附加Ortho Slice以查看结果foam.sub。</li>
</ul>
<p>加载项目WatershedSeparation-7-SeparatedPores.hx将完成此教程步骤（参见图4.48）。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.48.png" class="" title="图4.48：分离的孔隙">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.49.png" class="" title="图4.49：分水岭分离工作流程">
<h3 id="4-4-4-分离故障排除"><a href="#4-4-4-分离故障排除" class="headerlink" title="4.4.4 分离故障排除"></a>4.4.4 分离故障排除</h3><p>您可能会在结果中看到未分离的孔隙，或相反，孔隙的不需要的分离。因为它基于几何距离标准，分离将最适合凸形、几乎球形的对象。以下是改进分离的一些指南：</p>
<ul>
<li>如果您在特定切片上查看标记图像，一些孔隙中的标记可能似乎缺失，只是因为它们位于3D中的其他地方。</li>
<li>但是，在某些情况下，标记可能真的缺失，因为从距离图区域最大值的角度来看，两个对象被认为是合并的，然后分离也会缺失。您可以尝试降低H-Maxima（或Separate Objects）的对比度因子，使标记更小和更分离。</li>
<li>如果缺少分离，这意味着缺少标记，</li>
<li>分离”线”可能看起来太厚或错误，只是因为您正在查看的切片在某种程度上与分离面相切。</li>
<li>如果对象形状非凸：这会导致多个局部最大值，因此分离对象，可能会发生不需要的分离。对象中的小凹陷可能会导致贯穿它的分离。解决方案可能是增加H-Maxima的对比度因子，以使标记更大和合并，</li>
<li>基于距离图的分离可能会沿最短路径，即直线而不是所需的形状。这是因为分水岭由距离驱动：分离由几何标准驱动。</li>
<li>Chamfer Distance Map是离散的chamfer图。您可以使用更准确的欧几里得距离图（参见Distance Map或对象弹出菜单中Image Processing/Distance Maps中引用的其他距离图类型）；但是，在大多数情况下，这几乎没有影响。</li>
</ul>
<p>作为主要指导原则，分离的对象数量将与标记一样多。</p>
<p>如果结果不令人满意，可能有两种情况：</p>
<ul>
<li>对象数量不令人满意：在这种情况下，您必须处理标记。</li>
<li>分离线不令人满意：您必须处理优先级图，即”景观高度场”。</li>
</ul>
<p>对于标记,Separate Objects解决方案是处理距离图。在这种情况下,您考虑了几何形状(最内部区域),但标记可能通过其他方式获得。有时,如果粒子的中心更暗或更亮,使用灰度图像(强度)可能会很有趣。如果对象相当均匀,您必须坚持使用几何信息。可能需要调整H-Maxima的对比度因子设置。基本上,H-Maxima参数对应于两个最大值之间的最小深度。用地理类比:collar和summit之间的高度差,使您保持两个不同的峰。</p>
<p>改进的一种可能性是进行H-Maxima,然后用距离图的阈值图像遮罩结果。这避免了为小的连接部分保留标记,因为您只保留对应于距离图最大值且距离最小值的标记。</p>
<p>一旦对标记满意,对应于对象的数量,您还可以改进分离线。再次,上面描述的过程(Separate Objects)依赖于几何形状,您也可以使用深度的函数 - 直接使用灰度强度或强度梯度。可能有点困难地结合几何信息和强度信息。在某些情况下,您可以通过结合距离函数和强度函数来实现,例如,使用Blend With Image, Blend With Value或Arithmetic模块,以某种方式模拟人眼可以结合这两种信息的复杂方式。请注意,分水岭寻找线峰分离,因此局部最大值 - 与距离图一样,您可能需要使用函数的负值来达到这种情况。</p>
<p>改进分离的另一个强大技术是基于某些标准过滤由分水岭方法添加的分离:</p>
<ul>
<li>隔离添加的分离:使用AND NOT Image模块获取原始图像和分离图像之间的差异,</li>
<li>使用Labeling模块标记这些分离,</li>
<li>使用Label Analysis模块对每个分离进行一些测量,例如,分离区域内距离图值的最大值可能表明分离是否太深入对象内部。</li>
</ul>
<p>您将在下一个教程中找到更多使用不同方法创建标记和优先级图的分水岭应用示例。</p>
<h3 id="4-4-5-过滤单个对象"><a href="#4-4-5-过滤单个对象" class="headerlink" title="4.4.5 过滤单个对象"></a>4.4.5 过滤单个对象</h3><p>您可以测量已分离的个别对象。</p>
<p>首先,您需要将分离孔隙的二值图像转换为每个孔隙唯一标识的标签图像:</p>
<ul>
<li>将Labeling模块应用于分离孔隙图像(foam.sub)。</li>
<li>您可以附加Voxelized Rendering模块来查看标记图像。</li>
</ul>
<p>加载项目WatershedSeparation-8-SegmentedPores.hx将完成此教程步骤(见图4.50)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.50.png" class="" title="图4.50: 分割的孔隙">
<p>其次,您想过滤掉不需要的小对象,最后测量单个孔隙的体积。</p>
<p>为了移除小对象,您可以使用测量和测量过滤器,如入门教程中所述。这涉及两个步骤:</p>
<ul>
<li>将Filter By Measure模块附加到标签图像。</li>
<li>将foam.am设置为Input Intensity Image。</li>
<li>在Measure端口的大量可用测量列表中选择Volume3d。</li>
<li>将Number Of Objects端口设置为15以仅保留15个最大体积。按Apply。</li>
<li>可以使用Voxelized Rendering或Boundary Rendering模块来查看最大体积。</li>
<li>您还可以使用Label Analysis模块在表格面板中显示和管理特定测量。</li>
</ul>
<p>在下一个教程之一(第4.5章 - 进一步图像分析)中,您将找到测量和高级分析的更多应用示例。</p>
<p>加载项目WatershedSeparation-9-FilteredPores.hx将完成此教程步骤(见图4.51)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.51.png" class="" title="图4.51: 分割和过滤的孔隙">
<h3 id="4-4-6-几何重建"><a href="#4-4-6-几何重建" class="headerlink" title="4.4.6 几何重建"></a>4.4.6 几何重建</h3><p>最后,您可以重建气泡的几何形状:</p>
<ul>
<li>将Generate Surface模块附加到结果标签图像(foam3.labels),取消选中Border端口中的Adjust Coords,然后按Apply生成foam3.surf。</li>
<li>通过附加Surface View模块显示结果表面。</li>
</ul>
<p>加载项目WatershedSeparation-10-Reconstruction.hx将完成此教程步骤(见图4.52)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.52.png" class="" title="图4.52: 过滤孔隙的表面重建">
<p>由于结果图像已经包含材料标签的整数值,因此可以直接用于表面重建。其他图像类型可能需要转换为Avizo标签数据(例如,使用Convert Image Type模块)。请注意,Generate Surface模块可以处理超过256个标签。</p>
<p>使用Surface View模块显示结果表面可能会由于大量表面多边形而非常慢。在这种情况下,建议在显示之前先进行表面简化,以便在您的硬件上更快地显示。</p>
<p>Avizo还允许您将表面导出为各种文件格式,或生成和导出适合(例如)有限元模拟的四面体模型。</p>
<p>与本整个教程相对应的演示脚本可以在以下位置找到:</p>
<p>data/tutorials/image-processing-advanced/PorositySurfaceReconstruction.hx</p>
<p>它使用位于data/tutorials/image-processing-advanced中的脚本对象来自动化处理过程。它匹配图4.49所示的工作流程。</p>
<p>一旦加载脚本,您可以选择性地更改几个端口值,然后单击Action端口的Apply按钮开始处理。</p>
<h2 id="4-5-示例3-进一步图像分析-泡沫中孔径的分布"><a href="#4-5-示例3-进一步图像分析-泡沫中孔径的分布" class="headerlink" title="4.5 示例3: 进一步图像分析 - 泡沫中孔径的分布"></a>4.5 示例3: 进一步图像分析 - 泡沫中孔径的分布</h2><p>本示例展示了如何计算泡沫样品中孔径的分布,以及如何定义自定义测量来计算孔隙的球形度。</p>
<p>要学习本教程,您应该已经阅读了第4.1章 - 开始使用高级图像处理和定量分析,并且熟悉Avizo的基本操作。</p>
<p>本节分为以下步骤:</p>
<ul>
<li>孔隙检测</li>
<li>孔隙后处理</li>
<li>自定义测量组定义,用于确定孔径分布</li>
<li>自定义测量定义,用于计算孔隙的球形度</li>
</ul>
<p>本示例中使用的图像是通过微断层扫描获得的。它代表由材料和孔隙组成的泡沫。孔隙在图像中显示为暗色水平(低强度体素)。材料显示为明亮水平(高强度体素)。</p>
<ul>
<li>首先在AVIZO_ROOT目录中加载data/tutorials/image-processing-advanced/FoamPoro.am。</li>
<li>如果自动显示被禁用,连接一个Ortho Slice以在3D查看器中可视化数据,如图4.53所示。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.53.png" class="" title="图4.53: 泡沫孔隙的初始微断层扫描图像">
<h3 id="4-5-1-第一步-孔隙检测"><a href="#4-5-1-第一步-孔隙检测" class="headerlink" title="4.5.1 第一步: 孔隙检测"></a>4.5.1 第一步: 孔隙检测</h3><ul>
<li>将Interactive Thresholding连接到数据。</li>
<li>使用Threshold端口将图像阈值设置在0到50之间。</li>
<li>按Apply。</li>
<li>隐藏Interactive Thresholding模块,并将Ortho Slice连接到输出FoamPoro.thresholded。</li>
</ul>
<p>如图4.54所示,在0到50之间对图像进行阈值处理会得到一个二值图像,其中:<br>强度级别1 = 孔隙,强度级别0 = 支撑体(材料)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.54.png" class="" title="图4.54: 孔隙">
<h3 id="4-5-2-第二步-孔隙后处理"><a href="#4-5-2-第二步-孔隙后处理" class="headerlink" title="4.5.2 第二步: 孔隙后处理"></a>4.5.2 第二步: 孔隙后处理</h3><p>应用于二值图像的形态学Opening算子会生成另一个二值图像,其中:<br>小对象被移除,对象边界被平滑,一些对象可能被断开连接。</p>
<ul>
<li>将Opening模块连接到二值图像。</li>
<li>将Kernel Size设置为1。</li>
<li>按Apply。</li>
<li>将Ortho Slice连接到输出FoamPoro.opening。</li>
</ul>
<p>在先前计算的孔隙二值图像上应用形态学开运算会产生一个过滤后的图像,其中噪声和伪影被减少,如图4.55所示。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.55.png" class="" title="图4.55: 过滤后的孔隙">
<p>Separate Objects模块检测分离聚集颗粒的表面。这些表面从初始图像中减去,见图4.56。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.56.png" class="" title="图4.56: 孔隙后处理">
<ul>
<li>将Separate Objects模块连接到过滤后的二值图像。</li>
<li>将Marker Extent设置为1。</li>
<li>按Apply。</li>
<li>将Ortho Slice连接到输出FoamPoro.separate(见图4.57)。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.57.png" class="" title="图4.57: 分离的孔隙">
<h3 id="4-5-3-第三步-自定义测量组定义-用于确定孔径分布"><a href="#4-5-3-第三步-自定义测量组定义-用于确定孔径分布" class="headerlink" title="4.5.3 第三步: 自定义测量组定义,用于确定孔径分布"></a>4.5.3 第三步: 自定义测量组定义,用于确定孔径分布</h3><p>Avizo Label Analysis模块允许计算3D图像中每个颗粒的一组测量。一旦执行了单独分析,就可以绘制给定测量的直方图,以产生测量分布的表示。</p>
<ul>
<li>将Label Analysis模块连接到分离的二值图像。</li>
<li>将FoamPoro.am设置为Intensity Image。</li>
</ul>
<p>在模块的Measures端口中,basic是一组预选的原生测量。可能发生的情况是,您不需要basic测量组中的所有测量,或者您希望在分析表中捆绑一组不同的测量。对于这些情况,您可以创建自己的测量组。</p>
<p>对于给定的颗粒,等效直径测量计算与相同体积的球形颗粒的直径。因此,等效直径由以下公式给出:</p>
<script type="math/tex; mode=display">EqDiameter = \sqrt[3]{\frac{6×Volume 3d}{\pi}}</script><ul>
<li>按Measures端口的配置按钮(带3个点的按钮)。打开一个用于选择测量组的面板(见图4.58)。</li>
<li>通过按测量组选择器旁边的专用按钮(1)创建一个新的测量组。</li>
<li>在弹出窗口中,将新组命名为diameter并按OK。</li>
<li>在原生测量列表(2)中选择EqDiameter,并使用箭头按钮将其添加到组(3)。</li>
<li>按OK。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.58.png" class="" title="图4.58: 选择测量组">
<p>新的diameter组(仅包含等效直径测量)现在在Label Analysis模块的Measures端口中被选中。</p>
<ul>
<li>按Apply按钮。</li>
</ul>
<p>一个新的标签图像数据对象FoamPoro.label在项目视图中创建,并显示表格面板,以电子表格样式显示结果:分析FoamPoro.Label-Analysis,也在项目视图中创建(参见图5.60和图5.61)。</p>
<ul>
<li>在下方电子表格中选择EqDiameter列。</li>
<li>按工具栏中的直方图按钮。</li>
</ul>
<p>一个窗口打开,显示EqDiameter直方图,如图5.62所示。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.60.png" class="" title="图4.60:分析项目">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.61.png" class="" title="图4.61:分析电子表格">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.62.png" class="" title="图4.62:EqDiameter直方图">
<p>加载项目data/tutorials/image-processing-advanced/CustomerMeasurements-1-EquivalentDiameter.hx将完成上述步骤。</p>
<h3 id="4-5-4-第四步-自定义测量定义以计算孔的球形度"><a href="#4-5-4-第四步-自定义测量定义以计算孔的球形度" class="headerlink" title="4.5.4 第四步:自定义测量定义以计算孔的球形度"></a>4.5.4 第四步:自定义测量定义以计算孔的球形度</h3><p>Avizo提供了一组预定义的原生测量,但也可以保存用户定义的自定义测量。</p>
<ul>
<li>选择标签分析模块。</li>
<li>在属性面板中,按下Measures端口的配置按钮(带有3个点的按钮)。</li>
<li>如果还没有选择,请选择diameter组。</li>
<li>通过按专用按钮创建用户测量(参见图5.63）。</li>
<li>将其命名为Sphericity,然后按OK。</li>
</ul>
<p>测量编辑面板打开。</p>
<p>球形度是衡量一个对象有多球形的指标,表达为:</p>
<script type="math/tex; mode=display">\Psi = \frac{ π^{1/3} (6V)^{2/3} }{A}</script><p>其中V是粒子的体积,A是其表面积。</p>
<p>它是与给定粒子具有相同体积的球体的表面积与粒子表面积的比率。球体的球形度为1,根据等周不等式,任何不是球体的粒子的球形度将小于1。以下是几个对象球形度的示例:</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E8%A1%A8-object%20sphericity.png" class="" alt="表-object sphericity">
<p>这可以用Avizo测量表示为:</p>
<script type="math/tex; mode=display">(pi ** (1/3) * (6 * Volume3d) ** (2/3))/Area3d</script><ul>
<li>在面板的专用字段中输入球形度公式(参见图5.64)。</li>
<li>按关闭。</li>
<li>在用户测量列表中选择Sphericity,并使用箭头按钮将其添加到diameter组。</li>
<li>按OK。</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.63.png" class="" title="图4.63:用户测量定义按钮">
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.64.png" class="" title="图4.64:测量编辑">
<ul>
<li>按标签分析模块的Apply按钮。</li>
</ul>
<p>分析面板更新并显示EqDiameter和Sphericity测量。</p>
<p>提示:使用自定义组来仅选择所需的测量可以帮助加速分析过程。</p>
<p>注1:用户定义的数据(如自定义测量组或自定义测量)在工作会话结束时作为本地设置持久存在,因此在重新启动Avizo时可以检索它们。这些自定义数据也保存在项目脚本中。</p>
<p>注2:重要的是要提到,对于小孔(即由少数体素组成的孔)计算的球形度可能会超过1。这是因为Area 3D测量是用弦近似计算的(通常可以更好地近似面积),而Volume 3D测量不使用任何近似。</p>
<p>Avizo提供了强大的方法来定义自定义测量。有关更多详细信息,请参阅用户指南和参考指南。</p>
<p>加载项目data/tutorials/image-processing-advanced/CustomerMeasurements-2-Sphericity.hx将完成上述步骤。</p>
<h2 id="4-6-示例4-进一步图像分析-泡沫中材料的平均厚度"><a href="#4-6-示例4-进一步图像分析-泡沫中材料的平均厚度" class="headerlink" title="4.6 示例4:进一步图像分析 - 泡沫中材料的平均厚度"></a>4.6 示例4:进一步图像分析 - 泡沫中材料的平均厚度</h2><p>本教程展示了如何计算泡沫样品中材料的厚度。</p>
<p>要学习本教程,您应该已经阅读了第一个教程章节4.1 - 开始使用高级图像处理和定量分析,并且熟悉Avizo的基本操作。</p>
<p>在本教程的末尾,您将找到指向相应演示脚本的链接。</p>
<p>首先加载data/tutorials/image-processing-advanced/FoamPoro.am,这是一个通过微断层扫描获得的图像,存储在AVIZO_ROOT目录中。</p>
<p>它代表由材料和孔隙组成的泡沫。孔隙在图像中显示为暗色水平(低强度体素)。材料显示为亮色水平(高强度体素)。</p>
<p>该算法可以分为4个步骤:</p>
<ul>
<li>孔隙检测</li>
<li>分离面的检测</li>
<li>材料的距离图</li>
<li>材料平均厚度的计算</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.65.png" class="" title="图4.65:泡沫孔隙的微断层扫描图像">
<h3 id="4-6-1-孔隙检测"><a href="#4-6-1-孔隙检测" class="headerlink" title="4.6.1 孔隙检测"></a>4.6.1 孔隙检测</h3><p>重复上一教程的前几个步骤:使用阈值处理、形态学开运算和分离模块对初始图像进行处理,以获得过滤和分离的孔隙的二值图像。</p>
<p>加载项目PorosityThickness-1-SeparationObjects.hx将完成此教程步骤(参见图4.66)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.66.png" class="" title="图4.66:孔隙的二值图像">
<h3 id="4-6-2-分离面的检测"><a href="#4-6-2-分离面的检测" class="headerlink" title="4.6.2 分离面的检测"></a>4.6.2 分离面的检测</h3><p>这一步的目标是检测穿过材料的表面,这些表面与两个孔隙等距。影响区域(Influence Zones)模块:</p>
<ul>
<li>将二值图像作为输入,</li>
<li>给出一个二值图像作为输出,其中:<ul>
<li>输出图像中的每个蓝色体素离输入图像中区域中心的对象更近,</li>
<li>每个黑色体素至少等距于两个更近的对象。</li>
</ul>
</li>
</ul>
<p>对孔隙的二值图像FoamPoro.separate应用影响区域模块。</p>
<p>加载项目PorosityThickness-2-InfluenceZones.hx将完成此教程步骤(参见图4.67)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.67.png" class="" title="图4.67:影响区域图像&#x2F;骨架">
<p>NOT模块反转二值图像的水平。对影响区域骨架(SKIZ)应用NOT会产生一个二值图像,其中:</p>
<ul>
<li>输出图像中的每个黑色体素离输入图像中区域中心的对象更近,</li>
<li>每个蓝色体素至少等距于两个更近的对象。</li>
</ul>
<p>因此,影响区域和NOT的组合提供了一个穿过材料分离孔隙的表面的二值图像。</p>
<p>对FoamPoro.zones应用NOT模块。</p>
<p>加载项目PorosityThickness-3-SeparationSurfaces.hx将完成此教程步骤(参见图4.68)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.68.png" class="" title="图4.68:分离面图像">
<h3 id="4-6-3-材料的距离图"><a href="#4-6-3-材料的距离图" class="headerlink" title="4.6.3 材料的距离图"></a>4.6.3 材料的距离图</h3><p>对孔隙的二值图像FoamPoro.separate应用NOT。</p>
<p>这会产生一个二值图像,其中:</p>
<ul>
<li>输出图像中的每个黑色体素代表背景或孔隙体素,</li>
<li>每个蓝色体素代表材料体素。</li>
</ul>
<p>Chamfer Distance Map模块应用于二值图像会产生一个灰度图像,其中每个体素强度代表与对象边界的最小距离(以体素为单位)。对于给定的体素强度:</p>
<ul>
<li>强度级别 = 0 对应于孔隙或背景</li>
<li>强度级别 = 1 对应于材料包络</li>
<li>其他低级强度对应于靠近材料包络的材料部分</li>
<li>其他高级强度对应于远离材料包络的材料部分</li>
</ul>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.69.png" class="" title="图4.69:材料二值图像">
<p>对材料二值图像FoamPoro2.not应用3D解释的Chamfer Distance Map模块。</p>
<p>加载项目PorosityThickness-4-DistanceMap.hx将完成此教程步骤(参见图4.70)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.70.png" class="" title="图4.70:材料的距离图">
<p>Mask模块:</p>
<ul>
<li>将灰度图像作为第一个输入,</li>
<li>将二值图像作为第二个输入(掩码图像),</li>
<li>提供一个灰度图像作为输出,其中:<ul>
<li>掩码图像中的每个黑色体素在输出图像中设置为0,</li>
<li>掩码图像中的每个蓝色体素在输出图像中设置为来自灰度图像的初始水平。</li>
</ul>
</li>
</ul>
<p>对距离图图像FoamPoro2.distmap应用Mask模块,并将分离面图像FoamPoro.not设置为Input Binary Image。</p>
<p>用分离面图像掩蔽距离图图像会产生一个灰度图像,其中:</p>
<ul>
<li>每个非零强度代表分离面的一个体素,</li>
<li>强度值等于两个最近对象之间距离的一半(以体素为单位)。</li>
</ul>
<p>加载项目PorosityThickness-5-Mask.hx将完成此教程步骤(参见图4.71)。</p>
<img src="/2020/03/29/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-4/%E5%9B%BE4.71.png" class="" title="图4.71:分离面的距离图">
<h3 id="4-6-4-材料平均厚度的计算"><a href="#4-6-4-材料平均厚度的计算" class="headerlink" title="4.6.4 材料平均厚度的计算"></a>4.6.4 材料平均厚度的计算</h3><p>材料的平均厚度由以下公式给出:</p>
<script type="math/tex; mode=display">μ(Thk) = \frac{2 × V_{size} × \sum_i }{ NbVoxSep }</script><p>其中:</p>
<ul>
<li><script type="math/tex">V_{size}</script> = 体素尺寸(以微米为单位)</li>
<li><script type="math/tex">\sum_i</script> = 分离面距离图图像中体素强度的总和</li>
<li>NbVoxSep = 二值分离面图像中的体素数量</li>
</ul>
<p>带3D解释的Volume Fraction模块在”Label Voxel Count”列中给出3D图像中每个标签的标记体素数量。二值图像只有一个标签,所以”Label Voxel Count”返回NbVoxSep。</p>
<p>带3D解释的Intensity Integral模块在”Volume”列中给出3D图像中体素强度的总和,即<script type="math/tex">\sum_i</script>。</p>
<p>加载项目PorosityThickness-6-Thickness.hx将完成此教程步骤。</p>
<h2 id="4-7"><a href="#4-7" class="headerlink" title="4.7"></a>4.7</h2></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">HibisciDai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://hibiscidai.com/2020/03/29/Avizo用户使用手册-4/">http://hibiscidai.com/2020/03/29/Avizo用户使用手册-4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hibiscidai.com">HibisciDai</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AvizoUsersGuide/">AvizoUsersGuide</a><a class="post-meta__tags" href="/tags/%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/">用户使用手册</a></div><div class="social-share pull-right" data-disabled="linkedin,diandian"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/03/30/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-5/"><i class="fa fa-chevron-left">  </i><span>Avizo用户使用手册-5</span></a></div><div class="next-post pull-right"><a href="/2020/03/28/Avizo%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C-3/"><span>Avizo用户使用手册-3</span><i class="fa fa-chevron-right"></i></a></div></nav><div class="post-adv"><a target="_blank" rel="noopener" href="https://xn--mesr8b36x.agency/#/register?code=R5RS1JHy">好用、实惠、稳定的梯子,点击这里<img src="https://pic.imgdb.cn/item/65572abac458853aefef30cd.png" width="1000" height="124" object-fit="cover" ></a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNTQ2NC8xMjAwMA=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></div><footer class="footer-bg" style="background-image: url(/img/banner2.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2024 By HibisciDai</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>