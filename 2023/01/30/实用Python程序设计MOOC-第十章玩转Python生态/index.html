<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="实用Python程序设计MOOC-第十章玩转Python生态"><meta name="keywords" content="学习笔记,Python,PythonMOOC"><meta name="author" content="HibisciDai"><meta name="copyright" content="HibisciDai"><title>实用Python程序设计MOOC-第十章玩转Python生态 | HibisciDai</title><link rel="shortcut icon" href="/img/avatar.png"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="manifest" href="/manifest.json"><link rel="manifest" href="/manifest.json"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '6.1.0'
} </script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="HibisciDai" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81"><span class="toc-number">1.</span> <span class="toc-text">实用Python程序设计MOOC-第十章玩转Python生态</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Python%E7%9A%84%E5%BA%93"><span class="toc-number">2.</span> <span class="toc-text">使用Python的库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Python%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-number">3.</span> <span class="toc-text">安装Python第三方库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#cmd%E7%AA%97%E5%8F%A3%E5%AE%89%E8%A3%85"><span class="toc-number">3.1.</span> <span class="toc-text">cmd窗口安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pychram%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.</span> <span class="toc-text">pychram安装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Import%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">Import的用法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8datetime%E5%BA%93%E5%A4%84%E7%90%86%E6%97%A5%E6%9C%9F%E3%80%81%E6%97%B6%E9%97%B4"><span class="toc-number">5.</span> <span class="toc-text">用datetime库处理日期、时间</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E6%97%B6%E5%88%BB"><span class="toc-number">5.1.</span> <span class="toc-text">处理时刻</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8random%E5%BA%93%E5%A4%84%E7%90%86%E9%9A%8F%E6%9C%BA%E4%BA%8B%E5%8A%A1"><span class="toc-number">6.</span> <span class="toc-text">用random库处理随机事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="toc-number">6.1.</span> <span class="toc-text">用法示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E9%9A%8F%E6%9C%BA%E7%A7%8D%E5%AD%90"><span class="toc-number">6.1.1.</span> <span class="toc-text">设置随机种子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B04%E4%BA%BA%E7%8E%A9%E7%89%8C%E7%9A%84%E5%8F%91%E7%89%8C%E6%A8%A1%E6%8B%9F"><span class="toc-number">6.2.</span> <span class="toc-text">实现4人玩牌的发牌模拟</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Jieba%E8%BF%9B%E8%A1%8C%E5%88%86%E8%AF%8D"><span class="toc-number">7.</span> <span class="toc-text">使用Jieba进行分词</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8jieba%E5%BA%93%E6%89%BE%E5%87%BA%E4%B8%89%E5%9B%BD%E6%BC%94%E4%B9%89%E4%B8%AD%E5%87%BA%E5%9C%BA%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84%E5%87%A0%E4%B8%AA%E4%BA%BA"><span class="toc-number">7.1.</span> <span class="toc-text">用jieba库找出三国演义中出场次数最多的几个人</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8openpyxl%E5%A4%84%E7%90%86excel%E6%96%87%E6%A1%A3"><span class="toc-number">8.</span> <span class="toc-text">用openpyxl处理excel文档</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#excel%E6%96%87%E6%A1%A3%E7%9B%B8%E5%85%B3%E5%BA%93"><span class="toc-number">8.1.</span> <span class="toc-text">excel文档相关库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#openpyxl%E8%AF%BB%E5%8F%96excel%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">8.2.</span> <span class="toc-text">openpyxl读取excel文件内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%85%AC%E5%BC%8F%E7%9A%84%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C"><span class="toc-number">8.3.</span> <span class="toc-text">读取公式的计算结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#openpyxl%E5%88%9B%E5%BB%BAexcel%E6%96%87%E4%BB%B6"><span class="toc-number">9.</span> <span class="toc-text">openpyxl创建excel文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E6%89%80%E6%9C%89%E6%96%87%E6%9C%AC%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%95%B0%E8%BD%AC%E6%8D%A2%E4%B8%BA%E7%9C%9F%E6%AD%A3%E7%9A%84%E6%95%B0"><span class="toc-number">9.1.</span> <span class="toc-text">将所有文本形式的数转换为真正的数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E6%95%B0%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%96%87%E6%9C%AC%E5%BD%A2%E5%BC%8F"><span class="toc-number">9.2.</span> <span class="toc-text">将真正的数转换为文本形式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#openpyxl%E6%8C%87%E5%AE%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%B7%E5%BC%8F"><span class="toc-number">10.</span> <span class="toc-text">openpyxl指定单元格的样式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlrd%E8%AF%BB%E5%8F%96excel%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">11.</span> <span class="toc-text">xlrd读取excel文件内容</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlwt%E5%88%9B%E5%BB%BAexcel%E6%96%87%E4%BB%B6"><span class="toc-number">12.</span> <span class="toc-text">xlwt创建excel文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlwt%E5%90%91%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E5%85%AC%E5%BC%8F"><span class="toc-number">13.</span> <span class="toc-text">xlwt向单元格添加公式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlwt%E5%90%91%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E6%97%A5%E6%9C%9F"><span class="toc-number">14.</span> <span class="toc-text">xlwt向单元格添加日期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlwt%E5%90%91%E5%8D%95%E5%85%83%E6%A0%BC%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E8%B6%85%E9%93%BE%E6%8E%A5"><span class="toc-number">15.</span> <span class="toc-text">xlwt向单元格添加一个超链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xlwt%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">16.</span> <span class="toc-text">xlwt合并单元格</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8Pillow%E5%A4%84%E7%90%86%E5%9B%BE%E5%83%8F"><span class="toc-number">17.</span> <span class="toc-text">用Pillow处理图像</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%9A%84%E5%B8%B8%E8%AF%86"><span class="toc-number">17.1.</span> <span class="toc-text">图像的常识</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%9A%84%E7%BC%A9%E6%94%BE"><span class="toc-number">18.</span> <span class="toc-text">图像的缩放</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%9A%84%E6%97%8B%E8%BD%AC%E3%80%81%E7%BF%BB%E8%BD%AC%E5%9B%BE%E5%83%8F%E3%80%81-%E5%92%8C%E6%BB%A4%E9%95%9C%E6%95%88%E6%9E%9C"><span class="toc-number">19.</span> <span class="toc-text">图像的旋转、翻转图像、 和滤镜效果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%9A%84%E8%A3%81%E5%89%AA"><span class="toc-number">20.</span> <span class="toc-text">图像的裁剪</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BE%E5%83%8F%E7%9A%84%E7%B4%A0%E6%8F%8F%E5%8C%96"><span class="toc-number">21.</span> <span class="toc-text">图像的素描化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%99%E5%9B%BE%E5%83%8F%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0"><span class="toc-number">22.</span> <span class="toc-text">给图像添加水印</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8%E5%9B%BE%E5%83%8F%E4%B8%8A%E7%BB%98%E5%9B%BE%E5%92%8C%E5%86%99%E5%AD%97"><span class="toc-number">23.</span> <span class="toc-text">在图像上绘图和写字</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/Avatar.png"></div><div class="author-info__name text-center">HibisciDai</div><div class="author-info__description text-center">HibisciDai'Blog</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">219</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">75</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">29</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">友情链接</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://github.com/HibisciDai/hexo-theme-melody">HexoTheme-github</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://molunerfinn.com/">molunerfinn</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/banner2.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">HibisciDai</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">主页</a><a class="site-page" href="/about">关于我</a><a class="site-page" href="/archives">归档</a><a class="site-page" href="/tags">标签</a><a class="site-page" href="/categories">分类</a><a class="site-page" href="/gallery">相册</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">实用Python程序设计MOOC-第十章玩转Python生态</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-01-30</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">5.9k</span><span class="post-meta__separator">|</span><span>阅读时长: 27 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81.png" class="" title="实用Python程序设计MOOC-第十章玩转Python生态">
<p>实用Python程序设计MOOC-第十章玩转Python生态</p>
<span id="more"></span>
<p>[TOC]</p>
<h1 id="实用Python程序设计MOOC-第十章玩转Python生态"><a href="#实用Python程序设计MOOC-第十章玩转Python生态" class="headerlink" title="实用Python程序设计MOOC-第十章玩转Python生态"></a>实用Python程序设计MOOC-第十章玩转Python生态</h1><h1 id="使用Python的库"><a href="#使用Python的库" class="headerlink" title="使用Python的库"></a>使用Python的库</h1><ul>
<li>Python自带的库</li>
</ul>
<p>math，re，datetime，turtle，random</p>
<ul>
<li>无数第三方的库</li>
</ul>
<p>Pillow，jieba，request，matplotlib</p>
<h1 id="安装Python第三方库"><a href="#安装Python第三方库" class="headerlink" title="安装Python第三方库"></a>安装Python第三方库</h1><h2 id="cmd窗口安装"><a href="#cmd窗口安装" class="headerlink" title="cmd窗口安装"></a>cmd窗口安装</h2><p>1) 进入cmd命令行窗口<br>2) 进入安装Python的文件夹， 默认通常是:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\你的用户名\AppData\Loca1\Programs\Python\Python37</span><br></pre></td></tr></table></figure>
<p>不知道的话查找python.exe可以找到<br>3) 再进入scripts文件夹<br>4) pip install库名</p>
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/python%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95.png" class="" title="python安装目录">
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/pip%E5%91%BD%E4%BB%A4.png" class="" title="pip命令">
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/pip%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85pillow%E5%BA%93.png" class="" title="pip命令安装pillow库">
<h2 id="pychram安装"><a href="#pychram安装" class="headerlink" title="pychram安装"></a>pychram安装</h2><p>file - seting - project:xxx - Projet interpreter/Python解释器 - 点加号 -搜索第三方库 - 安装</p>
<h1 id="Import的用法"><a href="#Import的用法" class="headerlink" title="Import的用法"></a>Import的用法</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle	<span class="comment">#turtle是一个类</span></span><br><span class="line">turtle.setup(<span class="number">800</span>, <span class="number">600</span>)</span><br><span class="line">turtle.fd()</span><br></pre></td></tr></table></figure>
<p>或<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> turtle <span class="keyword">as</span> tt	<span class="comment">#此后tt等价于turtle</span></span><br><span class="line">tt.setup(<span class="number">800</span>, <span class="number">600</span>)</span><br><span class="line">tt.fd(<span class="number">100</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL.Image	<span class="comment">#PIL.Image是类中的类</span></span><br><span class="line">img = PIL.Image.<span class="built_in">open</span>(<span class="string">&quot;C:/tmp/pic/grass.jpg&quot;</span>)	<span class="comment">#将图像文件载入对象img</span></span><br><span class="line">img.show()</span><br></pre></td></tr></table></figure>
<p>或<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image	<span class="comment">#从PIL库导入Image类进行图像处理</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass.jpg&quot;</span>)	<span class="comment">#将图像文件载入对象img</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL.Image, PIL.ImageDraw, PIL.ImageFont</span><br><span class="line">img = PIL.Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass.jpg&quot;</span>)	<span class="comment">#将图像文件载入对象img</span></span><br><span class="line">draw = PIL.ImageDraw.Draw(img) <span class="comment">#以后就可以通过draw在img, 上画图、写字</span></span><br><span class="line">myFont = PIL.ImageFont.truetype(<span class="string">&quot;C:\\Windows\\Fonts\\simhei.ttf&quot;</span>，<span class="number">164</span>)</span><br></pre></td></tr></table></figure>
<p>或<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass.jpg&quot;</span>) <span class="comment">#将图像文件载入对象img</span></span><br><span class="line">draw = ImageDraw.Draw(img) <span class="comment">#以后就可以通过draw在img,上画图、写字</span></span><br><span class="line">myFont = ImageFont.truetype(<span class="string">&quot;C:\\Windows\\Fonts\\simhei.ttf&quot;</span>, <span class="number">164</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, colors, Alignment</span><br><span class="line">boldRedFont = Font(size = <span class="number">18</span>, name = <span class="string">&#x27;Times New Roman&#x27;</span>, bold = <span class="literal">True</span>, color = colors.RED)</span><br><span class="line">alignment = Alignment(horizontal = <span class="string">&#x27;left&#x27;</span>, vertical = <span class="string">&#x27;center&#x27;</span> )</span><br></pre></td></tr></table></figure>
<ul>
<li><p>datetime库处理时间相关</p>
</li>
<li><p>random库处理随机数相关</p>
</li>
<li><p>jieba库进行分词</p>
</li>
<li><p>openpyxl处理excel文档</p>
</li>
<li><p>Pillow处理图像</p>
</li>
</ul>
<h1 id="用datetime库处理日期、时间"><a href="#用datetime库处理日期、时间" class="headerlink" title="用datetime库处理日期、时间"></a>用datetime库处理日期、时间</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime	<span class="comment">#导入datetime模块</span></span><br><span class="line">dtBirth = datetime.date (<span class="number">2000</span>, <span class="number">9</span>, <span class="number">27</span>)	<span class="comment">#创建日期对象，日期为2000年9月27日</span></span><br><span class="line"><span class="built_in">print</span>(dtBirth.weekday()) <span class="comment">#&gt;&gt;2 输出dtBirth代表的日期是星期几,0表示星期一</span></span><br><span class="line"></span><br><span class="line">dtNow = datetime.date.today() <span class="comment">#取今天日期,假设是2020年8月15日</span></span><br><span class="line"><span class="built_in">print</span> (dtBirth &lt; dtNow)	<span class="comment">#&gt;&gt;True 日期可以比大小</span></span><br><span class="line"></span><br><span class="line">life = dtNow - dtBirth <span class="comment">#取两个日期的时间差</span></span><br><span class="line"><span class="built_in">print</span> (life.days, life.total_seconds()) <span class="comment">#&gt;&gt; 7262 627436800.0</span></span><br><span class="line"><span class="comment">#两个日期相差7262天，即627436800.0秒</span></span><br><span class="line"></span><br><span class="line">delta = datetime.timedelta(days = -<span class="number">10</span>) <span class="comment">#构造时间差对象，时间差为-10天</span></span><br><span class="line">newDate = dtNow + delta	<span class="comment">#newDate代表的日期是dtNow的日期往前数10天</span></span><br><span class="line"><span class="built_in">print</span> (newDate.year, newDate.month, newDate.day, newDate.weekday())	<span class="comment">#&gt;&gt;2020 8 5 2 2020年8月5日星期三</span></span><br><span class="line"><span class="built_in">print</span> (newDate.strftime(<span class="string">r&#x27;%m/%d/%Y&#x27;</span>)) <span class="comment">#&gt;&gt;08/05/2020</span></span><br><span class="line"></span><br><span class="line">newDate = datetime.datetime.strptime(<span class="string">&quot;2020.08.05&quot;</span>, <span class="string">&quot;%Y.%m.%d&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(newDate.strftime(<span class="string">&quot;%Y%m%d&quot;</span>))	<span class="comment">#&gt;&gt;20200805</span></span><br></pre></td></tr></table></figure>
<h2 id="处理时刻"><a href="#处理时刻" class="headerlink" title="处理时刻"></a>处理时刻</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">tm = datetime.datetime.now()	<span class="comment">#取当前时刻，精确到微秒</span></span><br><span class="line"><span class="built_in">print</span>(tm.year, tm.month, tm.day, tm.hour, tm.minute, tm.second, tm.microsecond)	<span class="comment">#&gt;&gt;2020 8 15 20 32 53 899669 假设当前时刻是2020年8月15日20时32分53秒899669微秒</span></span><br><span class="line"></span><br><span class="line">tm = datetime.datetime(<span class="number">2017</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">0</span>)	<span class="comment">#构造一个时刻,2017年8月10日15时56分10秒0微秒</span></span><br><span class="line"><span class="built_in">print</span>(tm.strftime(<span class="string">&quot;%Y%m%d %H:%M:%S&quot;</span>))	<span class="comment">#&gt;&gt;20170810 15:56:10</span></span><br><span class="line"><span class="built_in">print</span>(tm.strftime(<span class="string">&quot;%Y%m%d %I:%M:%S %p&quot;</span>)) <span class="comment">#20170810 03:56:10 PM</span></span><br><span class="line"></span><br><span class="line">tm2 = datetime.datetime.strptime(<span class="string">&quot;2013.08.10 22:31:24&quot;</span>, <span class="string">&quot;%Y.%m.%d %H:%M:%S&quot;</span>)	<span class="comment">#由字符串生成一个时间对象 </span></span><br><span class="line">delta = tm - tm2	<span class="comment">#求两个时间的时间差</span></span><br><span class="line"><span class="built_in">print</span>(delta.days, delta.seconds, delta.total_seconds())</span><br><span class="line"><span class="comment">#&gt;&gt;1460 62686 126206686.0 #时间差是1460天零62686秒, 总共126206686.0秒</span></span><br><span class="line"></span><br><span class="line">delta = tm2 - tm</span><br><span class="line"><span class="built_in">print</span>(delta.days, delta.seconds, delta.total_seconds())	<span class="comment">#&gt;&gt;-1461 23714 -126206686.0</span></span><br><span class="line">delta = datetime.timedelta(days = <span class="number">10</span>, hours = <span class="number">10</span>, minutes = <span class="number">30</span>, seconds = <span class="number">20</span>)	<span class="comment">#构造一个时间差，10天10小时30分20秒</span></span><br><span class="line"></span><br><span class="line">tm2 = tm + delta</span><br><span class="line"><span class="built_in">print</span>(tm2.strftime(<span class="string">&quot;%Y%m%d %H:%M:%S&quot;</span>)) <span class="comment">#&gt;&gt;20170821 02:26:30</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>datetime局限<br>能处理的时间是公元1年至9999年</p>
</blockquote>
<h1 id="用random库处理随机事务"><a href="#用random库处理随机事务" class="headerlink" title="用random库处理随机事务"></a>用random库处理随机事务</h1><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">random.random()</td>
<td style="text-align:center">随机生成一个[0, 1]之间的数</td>
</tr>
<tr>
<td style="text-align:center">random.uniform(x, y)</td>
<td style="text-align:center">随机生成一个[x,y]之间的数(含两端，下同)。x,y可以是小数</td>
</tr>
<tr>
<td style="text-align:center">random.randint(x, y)</td>
<td style="text-align:center">随机生成个[x,y]之间的整数。x,y都是整数</td>
</tr>
<tr>
<td style="text-align:center">random.randrange(x, y, z)</td>
<td style="text-align:center">在range(x, y, z)中随机取一个数</td>
</tr>
<tr>
<td style="text-align:center">random.choice(x)</td>
<td style="text-align:center">从序列x中随机取一个元素。x可以是为列表、元组、字符串</td>
</tr>
<tr>
<td style="text-align:center">random.shuffle(x)</td>
<td style="text-align:center">将列表x的元素顺序随机打乱</td>
</tr>
<tr>
<td style="text-align:center">random.sample(x, n)</td>
<td style="text-align:center">从序列x中随机取一个长度为n的子序列。x可以是元组、列表、集合</td>
</tr>
<tr>
<td style="text-align:center">random.seed(x)</td>
<td style="text-align:center">设置随机种子为x。x可以是个数、元组、字符串</td>
</tr>
</tbody>
</table>
</div>
<h2 id="用法示例"><a href="#用法示例" class="headerlink" title="用法示例"></a>用法示例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="built_in">print</span>(random.random())	<span class="comment">#&gt;&gt;0.5502568034876353</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.uniform(<span class="number">1.2</span>, <span class="number">7.8</span>))	<span class="comment">#&gt;&gt;5.147405813383391</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.randint(-<span class="number">20</span>, <span class="number">70</span>))	<span class="comment">#&gt;&gt;20</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.randrange(<span class="number">2</span>, <span class="number">20</span>, <span class="number">3</span>))	<span class="comment">#&gt;&gt;17 &quot;2 5 8 11 14 17 (20不算)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.choice(<span class="string">&quot;hello,world&quot;</span>)) <span class="comment">#&gt;&gt;d</span></span><br><span class="line"><span class="built_in">print</span>(random.choice([<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;ok&#x27;</span>, <span class="number">34.6</span>, <span class="string">&#x27;jack&#x27;</span>]))	<span class="comment">#&gt;&gt;ok</span></span><br><span class="line"></span><br><span class="line">lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">random.shuffle(lst)</span><br><span class="line"><span class="built_in">print</span>(lst)	<span class="comment">#&gt;&gt;[5, 3, 4, 2, 1, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.sample(lst, <span class="number">3</span>))	<span class="comment">#&gt;&gt;[6, 2, 3]</span></span><br></pre></td></tr></table></figure>
<h3 id="设置随机种子"><a href="#设置随机种子" class="headerlink" title="设置随机种子"></a>设置随机种子</h3><p>生活中真实的随机数是不可预测的，当计算机中初始条件设置后是可以预测的。<br>正常情况（缺省）运行random时候是以当前的时间来作为种子，当种子一样时候，生成的随机数是一样的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">2</span>)	<span class="comment">#或random.seed(&quot;ok&quot;)....种子可以是随便什么数、字符串...</span></span><br><span class="line"><span class="comment">#则下面程序每次运行结果都一样</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.random())</span><br><span class="line"><span class="built_in">print</span>(random.uniform(<span class="number">1.2</span>, <span class="number">7.8</span>))</span><br><span class="line"><span class="built_in">print</span>(random.randint(-<span class="number">20</span>, <span class="number">70</span>))</span><br><span class="line"><span class="built_in">print</span>(random.randrange(<span class="number">2</span>, <span class="number">30</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(random.choice(<span class="string">&quot;hello,world&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(random.choice([<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;ok&#x27;</span>, <span class="number">34.6</span>, <span class="string">&#x27;jack&#x27;</span>]))</span><br><span class="line">lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">random.shuffle(lst)</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="built_in">print</span>(random.sample(lst, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<h2 id="实现4人玩牌的发牌模拟"><a href="#实现4人玩牌的发牌模拟" class="headerlink" title="实现4人玩牌的发牌模拟"></a>实现4人玩牌的发牌模拟</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">cards = [<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">11</span>)]</span><br><span class="line">cards.extend(<span class="built_in">list</span>(<span class="string">&quot;JQKA&quot;</span>))  <span class="comment"># cards是[&#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;10&#x27;，&#x27;J&#x27;，&#x27;Q&#x27;, &#x27;K&#x27;, &#x27;A&#x27;]</span></span><br><span class="line">allCards = []  <span class="comment"># 一副牌</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> <span class="string">&quot;♣♦♥♠&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cards:</span><br><span class="line">        allCards.append(s + c)  <span class="comment"># allCards元素形式如:&#x27;♠3&#x27;</span></span><br><span class="line"></span><br><span class="line">random.shuffle(allCards)  <span class="comment"># 随机打乱52张牌</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    onePlayer = allCards[i::<span class="number">4</span>]  <span class="comment"># 每个玩家都是隔三张牌取一张</span></span><br><span class="line">    onePlayer.sort()  <span class="comment"># 扑克牌排序规则略复杂，这个排序不太完美</span></span><br><span class="line">    <span class="built_in">print</span>(onePlayer)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;♠4&#x27;, &#x27;♠8&#x27;, &#x27;♠K&#x27;, &#x27;♠Q&#x27;, &#x27;♣2&#x27;, &#x27;♣J&#x27;, &#x27;♥3&#x27;, &#x27;♥8&#x27;, &#x27;♥K&#x27;, &#x27;♦10&#x27;, &#x27;♦6&#x27;, &#x27;♦J&#x27;, &#x27;♦Q&#x27;]</span><br><span class="line">[&#x27;♠2&#x27;, &#x27;♠3&#x27;, &#x27;♠6&#x27;, &#x27;♠J&#x27;, &#x27;♣10&#x27;, &#x27;♣7&#x27;, &#x27;♣Q&#x27;, &#x27;♥10&#x27;, &#x27;♥4&#x27;, &#x27;♥5&#x27;, &#x27;♥A&#x27;, &#x27;♦2&#x27;, &#x27;♦8&#x27;]</span><br><span class="line">[&#x27;♠7&#x27;, &#x27;♠9&#x27;, &#x27;♣3&#x27;, &#x27;♣4&#x27;, &#x27;♣8&#x27;, &#x27;♣K&#x27;, &#x27;♥2&#x27;, &#x27;♥6&#x27;, &#x27;♥Q&#x27;, &#x27;♦3&#x27;, &#x27;♦7&#x27;, &#x27;♦9&#x27;, &#x27;♦A&#x27;]</span><br><span class="line">[&#x27;♠10&#x27;, &#x27;♠5&#x27;, &#x27;♠A&#x27;, &#x27;♣5&#x27;, &#x27;♣6&#x27;, &#x27;♣9&#x27;, &#x27;♣A&#x27;, &#x27;♥7&#x27;, &#x27;♥9&#x27;, &#x27;♥J&#x27;, &#x27;♦4&#x27;, &#x27;♦5&#x27;, &#x27;♦K&#x27;]</span><br></pre></td></tr></table></figure>
<h1 id="使用Jieba进行分词"><a href="#使用Jieba进行分词" class="headerlink" title="使用Jieba进行分词"></a>使用Jieba进行分词</h1><p>“买马上战场”应该分成”买 马 上 战场”还是”买 马上 战场”?<br>不容易解决，分词库jieba也不是总能解决。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jieba	<span class="comment">#导入分词库</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;我们热爱中华人民共和国&quot;</span></span><br><span class="line">lst = jieba.lcut(s)	<span class="comment">#分词的结果是一个列表</span></span><br><span class="line"><span class="comment">#默认用精确模式分词，分出的结果正好拼成原文</span></span><br><span class="line"><span class="built_in">print</span>(lst)	<span class="comment">#&gt;&gt;[&#x27;我们&#x27;, &#x27;热爱&#x27;, &#x27;中华人民共和国&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(s, cut_all = <span class="literal">True</span>))	<span class="comment">#全模式分词,输出所有可能的词</span></span><br><span class="line"><span class="comment">#&gt;&gt;[&#x27;我们&#x27;, &#x27;热爱&#x27;, &#x27;中华&#x27;, &#x27;中华人民&#x27;, &#x27;中华人民共和国&#x27;, &#x27;华人&#x27;, &#x27;人民&#x27;, &#x27;人民共和国&#x27;, &#x27;共和&#x27;, &#x27;共和国&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut_for_search(s))	<span class="comment">#搜索引擎模式分词</span></span><br><span class="line"><span class="comment">#&gt;&gt;[&#x27;我们&#x27;, &#x27;热爱&#x27;, &#x27;中华&#x27;, &#x27;华人&#x27;, &#x27;人民&#x27;, &#x27;共和&#x27;, &#x27;共和国&#x27;, &#x27;中华人民共和国&#x27;]</span></span><br><span class="line">s = <span class="string">&quot;拼多多是个网站&quot;</span></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(s))	<span class="comment">#&gt;&gt;[&#x27;拼&#x27;, &#x27;多多&#x27;, &#x27;是&#x27;, &#x27;个&#x27;, &#x27;网站&#x27;]</span></span><br><span class="line">jieba.add_word(<span class="string">&quot;拼多多&quot;</span>)	<span class="comment">#往词典添加新词</span></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(s))	<span class="comment">#&gt;&gt;[&#x27;拼多多&#x27;, &#x27;是&#x27;, &#x27;个&#x27;, &#x27;网站&#x27;]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;高克丝马微中&quot;</span></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(s)) <span class="comment">#&gt;&gt;[&#x27;高克丝&#x27;, &#x27;马微&#x27;, &#x27;中&#x27;]</span></span><br><span class="line"></span><br><span class="line">jieba.load_userdict(<span class="string">&quot;C:/tmp/tmpdict.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(s))	<span class="comment">#&gt;&gt;[&#x27;高克&#x27;, &#x27;丝马&#x27;, &#x27;微中&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(jieba.lcut(<span class="string">&quot;显微中，容不得一丝马虎。&quot;</span>))	<span class="comment">#&gt;&gt;[&#x27;显微&#x27;, &#x27;中&#x27;, &#x27;容不得&#x27;, &#x27;一丝&#x27;, &#x27;马虎&#x27;, &#x27;。&#x27;]</span></span><br></pre></td></tr></table></figure>
<p><code>c:/tmp/tmpdict.txt</code> 文件内容如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">高克</span><br><span class="line">丝马</span><br><span class="line">微中</span><br></pre></td></tr></table></figure>
<h2 id="用jieba库找出三国演义中出场次数最多的几个人"><a href="#用jieba库找出三国演义中出场次数最多的几个人" class="headerlink" title="用jieba库找出三国演义中出场次数最多的几个人"></a>用jieba库找出三国演义中出场次数最多的几个人</h2><p>分词后对所有词进行频率统计并输出出现最多的15个词(单个字的词去掉) :</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">曹操 929, 孔明 825, 将军 756, 却说 646, 玄德 556, 关公 508, 丞相 484, 二人 459, 不可 432, 荆州 417, 孔明曰 383, 不能 380, 玄德日 380, 如此 375, 张飞 349,</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;&#x27;c:/tmp/三国演义utf8.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">text = f.read()	<span class="comment">#字符串text就是全部三国演义文本</span></span><br><span class="line">f.close()</span><br><span class="line">words = jieba.lcut(text)	<span class="comment">#word是分出来的所有词</span></span><br><span class="line">result = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(word) == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">continue</span></span><br><span class="line">	<span class="keyword">elif</span> word <span class="keyword">in</span> (<span class="string">&quot;诸葛亮&quot;</span>, <span class="string">&quot;孔明曰&quot;</span>):</span><br><span class="line">		word = <span class="string">&quot;孔明&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> word <span class="keyword">in</span> (<span class="string">&quot;关公&quot;</span>, <span class="string">&quot;云长&quot;</span>, <span class="string">&quot;关云长&quot;</span>):</span><br><span class="line">		word = <span class="string">&quot;关羽&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> word <span class="keyword">in</span> (<span class="string">&quot;玄德&quot;</span>, <span class="string">&quot;玄德日&quot;</span>):</span><br><span class="line">		word = <span class="string">&quot;刘备&quot;</span></span><br><span class="line">	<span class="keyword">elif</span> word <span class="keyword">in</span> (<span class="string">&quot;孟德&quot;</span>, <span class="string">&quot;操贼&quot;</span>, <span class="string">&quot;曹阿瞒&quot;</span>):</span><br><span class="line">		word = <span class="string">&quot;曹操&quot;</span></span><br><span class="line">	result[word] = result.get(word, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">noneNames = &#123;<span class="string">&#x27;将军&#x27;</span>, <span class="string">&#x27;却说&#x27;</span>, <span class="string">&#x27;荆州&#x27;</span>, <span class="string">&#x27;二人&#x27;</span>, <span class="string">&#x27;不可&#x27;</span>, <span class="string">&#x27;不能&#x27;</span>, <span class="string">&#x27;如此&#x27;</span>, <span class="string">&#x27;丞相&#x27;</span> ,<span class="string">&quot;商议&quot;</span>, <span class="string">&quot;如何&quot;</span>, <span class="string">&quot;主公&quot;</span>, <span class="string">&quot;军士&quot;</span>, <span class="string">&quot;左右&quot;</span>, <span class="string">&quot;军马&quot;</span>, <span class="string">&quot;引兵&quot;</span>, <span class="string">&quot;次日&quot;</span>&#125; <span class="comment">#用集合比列表、元组快</span></span><br><span class="line"><span class="keyword">for</span> word <span class="keyword">in</span> noneNames:	<span class="comment">#删除noneName中的词</span></span><br><span class="line">	result.pop(word)</span><br><span class="line">items = <span class="built_in">list</span>(result.items())</span><br><span class="line">items.sort(key = <span class="keyword">lambda</span> x : -x[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">	<span class="built_in">print</span>(items[i][<span class="number">0</span>], items[i][<span class="number">1</span>], end=<span class="string">&quot;, &quot;</span>)	<span class="comment">#输出 人名 出现次数，</span></span><br></pre></td></tr></table></figure>
<p>输出:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">孔明 1366, 刘备 1204, 曹操 973, 关羽 814, 张飞 349, 吕布 299, 孙权 264, 大喜 262, 东吴 252, 天下 252, 赵云 251, 于是 250, 今日 242, 魏兵 234, 不敢 234,</span><br></pre></td></tr></table></figure></p>
<h1 id="用openpyxl处理excel文档"><a href="#用openpyxl处理excel文档" class="headerlink" title="用openpyxl处理excel文档"></a>用openpyxl处理excel文档</h1><h2 id="excel文档相关库"><a href="#excel文档相关库" class="headerlink" title="excel文档相关库"></a>excel文档相关库</h2><ul>
<li>office 2010前.xls文件</li>
</ul>
<p>用xlrd库读取<br>用xlwt库创建和修改</p>
<ul>
<li>office 2010及之后.xlsx文件</li>
</ul>
<p>用openpyxl库读写(官网: openpyxl.readthedocs.io)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install openpyxl (不支持Python 3.5及以前版本)</span><br><span class="line">Python 3.5及以前: pip install openpyxl == 2.6.4</span><br></pre></td></tr></table></figure>
<h2 id="openpyxl读取excel文件内容"><a href="#openpyxl读取excel文件内容" class="headerlink" title="openpyxl读取excel文件内容"></a>openpyxl读取excel文件内容</h2><ul>
<li>获取工作表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sheet = book.active	<span class="comment">#取活跃的工作表(缺省就是第0张工作表)</span></span><br><span class="line">sheet = book[<span class="string">&quot;price&quot;</span>]	<span class="comment">#取名为&quot;price&quot;的工作表</span></span><br></pre></td></tr></table></figure>
<ul>
<li>遍历所有工作表， 并打出其名字:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> book.worksheets: <span class="comment">#worksheets是工作表构成的列表</span></span><br><span class="line">	<span class="built_in">print</span>(sheet.title)</span><br></pre></td></tr></table></figure>
<ul>
<li>单元格属性</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span>(ce11.value)	:	<span class="built_in">int</span>, <span class="built_in">float</span>, <span class="built_in">str</span>, datetime.datetime</span><br><span class="line">ce1l.coordinate	:	<span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;E3&#x27;</span></span><br><span class="line">cell.col_idx	:	单元格列号</span><br><span class="line">cell.number_format	:	数的显示格式,<span class="string">&quot;General&quot;</span>, <span class="string">&quot;0.00%&quot;</span>, <span class="string">&quot;0.00E+00&quot;</span>等</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> pxl</span><br><span class="line">book = pxl.load_workbook(<span class="string">&quot;c:/tmp/test.xlsx&quot;</span>)	<span class="comment">#book就是整个excel文件</span></span><br><span class="line">sheet = book.worksheets[<span class="number">0</span>]	<span class="comment">#取第0张工作表</span></span><br><span class="line"><span class="built_in">print</span>(sheet.title)	<span class="comment">#输出工作表名字(显示于工作表下方标签)</span></span><br><span class="line"><span class="built_in">print</span>(sheet.min_row, sheet.max_row) <span class="comment">#输出最小有效行号、最大有效行号</span></span><br><span class="line"><span class="built_in">print</span>(sheet.min_column, sheet.max_column)	<span class="comment">#输出最小有效列号、最大有效列号</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.rows:	<span class="comment">#按行遍历整个工作表，从第1行到sheet.max_row行(含)</span></span><br><span class="line">	<span class="keyword">for</span> cell <span class="keyword">in</span> row:	<span class="comment">#遍历一行的每个单元格。cell是一个单元格</span></span><br><span class="line">		<span class="built_in">print</span>(cell.value)	<span class="comment">#cell.value是单元格的值，空单元格值是None</span></span><br><span class="line"><span class="keyword">for</span> cell <span class="keyword">in</span> sheetp[<span class="string">&#x27;G&#x27;</span>]:	<span class="comment">#遍历名为&#x27;G&#x27;的那一列</span></span><br><span class="line">	<span class="built_in">print</span>(cell.value)</span><br><span class="line"><span class="keyword">for</span> cell <span class="keyword">in</span> sheet[<span class="number">3</span>]:	<span class="comment">#遍历第3行</span></span><br><span class="line">	<span class="built_in">print</span>(cell.value, <span class="built_in">type</span>(cell.value), cell.coordinate, cell.col_idx, cell.number_format)</span><br><span class="line"><span class="built_in">print</span>(pxl.utils.get_colum_letter(<span class="number">5</span>))	<span class="comment">#&gt;&gt;E 根据列号求列名</span></span><br><span class="line"><span class="built_in">print</span>(pxl.utils.column_index_from_string(<span class="string">&#x27;D&#x27;</span>))	<span class="comment">#&gt;&gt;4 根据列名求列号</span></span><br><span class="line"><span class="built_in">print</span>(pxl.utils.column_index_from_string(<span class="string">&#x27;AC&#x27;</span>))	<span class="comment">#&gt;&gt;29</span></span><br><span class="line">colRange = sheet[<span class="string">&#x27;C:F&#x27;</span>]	<span class="comment">#colRange代表从第C列到第F列(含F列)</span></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> colRange:	<span class="comment">#按列遍历第C列到第F列，col代表一列</span></span><br><span class="line">	<span class="keyword">for</span> cell <span class="keyword">in</span> col:	<span class="comment">#cell是一个单元格</span></span><br><span class="line">		<span class="built_in">print</span>(cell.value)</span><br><span class="line">rowRange = sheet[<span class="number">5</span>:<span class="number">10</span>]	<span class="comment">#rowRange代表第5行到第10行(含第10行)</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet[<span class="string">&#x27;A1&#x27;</span>:<span class="string">&#x27;D2&#x27;</span>]:	<span class="comment">#按行遍历左上角是A1右下角是D2的子表</span></span><br><span class="line">	<span class="keyword">for</span> cell <span class="keyword">in</span> row:	<span class="comment">#row[i]也可以表示第i个单元格</span></span><br><span class="line">		<span class="built_in">print</span>(cell.value)</span><br><span class="line"><span class="built_in">print</span>(sheet[<span class="string">&#x27;C9&#x27;</span>].value)	<span class="comment">#输出C9单元格的值</span></span><br><span class="line"><span class="built_in">print</span>(sheet.cell(row=<span class="number">8</span>, column=<span class="number">4</span>).value)	<span class="comment">#输出第8行第4列单元格的值</span></span><br></pre></td></tr></table></figure>
<h2 id="读取公式的计算结果"><a href="#读取公式的计算结果" class="headerlink" title="读取公式的计算结果"></a>读取公式的计算结果</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line">wb = openpyxl.load_workbook(<span class="string">&quot;C:/tmp/style.xlsx&quot;</span>, data_only = <span class="literal">True</span>)</span><br><span class="line">ws = wb.worksheets[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(ws[<span class="string">&#x27;A3&#x27;</span>].value)</span><br></pre></td></tr></table></figure>
<h1 id="openpyxl创建excel文件"><a href="#openpyxl创建excel文件" class="headerlink" title="openpyxl创建excel文件"></a>openpyxl创建excel文件</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">book = openpyxl.Workbook()	<span class="comment">#在内存创建一个excel文档，注意W是大写</span></span><br><span class="line">sheet = book.active	<span class="comment">#取第0个工作表</span></span><br><span class="line">sheet.title = <span class="string">&quot;sample1&quot;</span>	<span class="comment">#工作表取名为sample1</span></span><br><span class="line">dataRows = ((<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40.5</span>), (<span class="number">100</span>, <span class="number">200</span>, <span class="string">&#x27;=sum(A1:B2)&#x27;</span>), [], [<span class="string">&#x27;1000&#x27;</span>, datetime.datetime.now(), <span class="string">&#x27;ok&#x27;</span>])</span><br><span class="line"><span class="comment">#时间显示是特别长的</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> dataRows:</span><br><span class="line">	sheet.append(row)	<span class="comment">#在工作表中添加一行</span></span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;B&#x27;</span>].width = <span class="built_in">len</span>(<span class="built_in">str</span>(sheet[<span class="string">&#x27;B4&#x27;</span>].value))	<span class="comment">#设置B列宽度,使其能完整显示B4单元格里的时间</span></span><br><span class="line">sheet[<span class="string">&#x27;E1&#x27;</span>].value = <span class="string">&quot;=sum(A1:D1)&quot;</span>	<span class="comment">#单元格值为公式</span></span><br><span class="line">sheet[<span class="string">&#x27;E2&#x27;</span>].value = <span class="number">12.5</span>	<span class="comment">#单元格值为小数</span></span><br><span class="line">sheet[<span class="string">&quot;E2&quot;</span>].number_format = <span class="string">&quot;0.00%&quot;</span>	<span class="comment">#单元格显示格式是百分比形式</span></span><br><span class="line">sheet[<span class="string">&#x27;F1&#x27;</span>].value = <span class="number">3500</span>	<span class="comment">#单元格值类型为int</span></span><br><span class="line">sheet[<span class="string">&#x27;F2&#x27;</span>].value =	<span class="string">&quot;35.00&quot;</span>	<span class="comment">#单元格值类型为str</span></span><br><span class="line">sheet[<span class="string">&#x27;F3&#x27;</span>].value = datetime.datetime.today().date()</span><br><span class="line">sheet.column_dimensions[<span class="string">&#x27;F&#x27;</span>].width = <span class="built_in">len</span>(<span class="built_in">str</span>(sheet[<span class="string">&#x27;F3&#x27;</span>].value))</span><br><span class="line">sheet.row_dimensions[<span class="number">2</span>].height = <span class="number">48</span>	<span class="comment">#设置第2行高度为48points</span></span><br><span class="line">sheet2 = book.create_sheet(<span class="string">&quot;Sample2&quot;</span>)	<span class="comment">#添加名为Sample2的工作表</span></span><br><span class="line">sheet2[<span class="string">&quot;A1&quot;</span>] = <span class="number">50</span></span><br><span class="line">sheet2 = book.create_sheet(<span class="string">&quot;Sample0&quot;</span>, <span class="number">0</span>)	<span class="comment">#添加名为sample0的工作表</span></span><br><span class="line">sheet3 = book.copy_worksheet(sheet)	<span class="comment">#添加一张新工作表,其为sheet的拷贝</span></span><br><span class="line">book.remove_sheet(book[<span class="string">&quot;Sample2&quot;</span>])	<span class="comment">#删除名为Sample2的工作表</span></span><br><span class="line">book.save(<span class="string">&#x27;C:/tmp/sample.xlsx&#x27;</span>)	<span class="comment">#保存文件</span></span><br></pre></td></tr></table></figure>
<h2 id="将所有文本形式的数转换为真正的数"><a href="#将所有文本形式的数转换为真正的数" class="headerlink" title="将所有文本形式的数转换为真正的数"></a>将所有文本形式的数转换为真正的数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> pxl</span><br><span class="line">book = pxl.load_workbook(<span class="string">&quot;C:/tmp/test2.xlsx&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> book.worksheets:</span><br><span class="line">	<span class="keyword">for</span> row <span class="keyword">in</span> sheet.rows:</span><br><span class="line">		<span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">			v = cell.value</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">type</span>(v) == <span class="built_in">str</span>:</span><br><span class="line">				<span class="keyword">if</span> v.isdigit():	<span class="comment">#如果v全部由数字组成</span></span><br><span class="line">					cell.value = <span class="built_in">int</span>(v)</span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					<span class="keyword">try</span>:</span><br><span class="line">						cell.value = <span class="built_in">float</span>(v) <span class="comment">#如果不是小数格式，转换会引发异常</span></span><br><span class="line">					<span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line">book.save(<span class="string">&quot;C:/tmp/test3.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="将真正的数转换为文本形式"><a href="#将真正的数转换为文本形式" class="headerlink" title="将真正的数转换为文本形式"></a>将真正的数转换为文本形式</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> pxl</span><br><span class="line">book = pxl.load_workbook(<span class="string">&quot;c:/tmp/test2.xlsx&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> sheet <span class="keyword">in</span> book.worksheets:</span><br><span class="line">	<span class="keyword">for</span>	row <span class="keyword">in</span> sheet.rows:</span><br><span class="line">		<span class="keyword">for</span> cell <span class="keyword">in</span> row :</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">type</span>(cell.value) == <span class="built_in">int</span> <span class="keyword">or</span> <span class="built_in">type</span>(cell.value) == <span class="built_in">float</span>:</span><br><span class="line">				cell.value = <span class="built_in">str</span>(cell.value)</span><br><span class="line">book.save(<span class="string">&quot;c:/tmp/test3.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="openpyxl指定单元格的样式"><a href="#openpyxl指定单元格的样式" class="headerlink" title="openpyxl指定单元格的样式"></a>openpyxl指定单元格的样式</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"><span class="keyword">from</span> openpyxl.styles <span class="keyword">import</span> Font, colors, PatternFill, Alignment, Side, Border</span><br><span class="line">book = openpyxl.Workbook() <span class="comment">#在内存创建一个excel文档，注意W是大写</span></span><br><span class="line">sheet = book.active <span class="comment">#取第0个工作表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): <span class="comment">#添加4行5列数据</span></span><br><span class="line">	sheet.append([i*<span class="number">5</span> + j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)])</span><br><span class="line"></span><br><span class="line">side = Side(style=<span class="string">&quot;thin&quot;</span>) <span class="comment">#边线类型, 还可以是 &quot;thick&quot;,&quot;medium&quot;,&quot;dotted&quot;等</span></span><br><span class="line">border = Border(left=side, right=side, top=side, bottom=side) <span class="comment">#边框类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.rows:</span><br><span class="line">	<span class="keyword">for</span> cell <span class="keyword">in</span> row:</span><br><span class="line">		cell.border = border <span class="comment">#为单元格设置边框类型</span></span><br><span class="line"></span><br><span class="line">sheet[<span class="string">&#x27;A1&#x27;</span>].fill = PatternFill(patternType=<span class="string">&#x27;solid&#x27;</span>, fgColor=<span class="string">&quot;00ff00&quot;</span>)</span><br><span class="line"><span class="comment">#纯色填充，单元格底色设置为绿色,00ff00表示红色分量0，绿色分量255,蓝色分量0</span></span><br><span class="line">a1 = sheet[<span class="string">&#x27;A1&#x27;</span>]</span><br><span class="line">italicRedFont = Font(size=<span class="number">18</span>, name=<span class="string">&#x27;Times New Roman&#x27;</span>, bold=<span class="literal">True</span>, color=colors.RED)</span><br><span class="line">a1.font = italicRedFont <span class="comment">#设置单元格字体</span></span><br><span class="line"></span><br><span class="line">sheet[<span class="string">&#x27;A2&#x27;</span>].font = sheet[<span class="string">&#x27;A1&#x27;</span>].font.copy(italic = <span class="literal">True</span>)	<span class="comment">#A2的字体和A1的字体一样，但是是斜体</span></span><br><span class="line"></span><br><span class="line">sheet.merge_cells(<span class="string">&#x27;C2:D3&#x27;</span>) <span class="comment">#从C2到D3合并为一个单元格，此后名为 C2</span></span><br><span class="line"></span><br><span class="line">sheet[<span class="string">&#x27;C2&#x27;</span>].alignment = Alignment(horizontal=<span class="string">&#x27;left&#x27;</span>, vertical=<span class="string">&#x27;center&#x27;</span>)	<span class="comment">#C2文字水平左对齐，垂直居中</span></span><br><span class="line">book.save(<span class="string">&quot;c:/tmp/style.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/openpyxl%E6%8C%87%E5%AE%9A%E5%8D%95%E5%85%83%E6%A0%BC%E7%9A%84%E6%A0%B7%E5%BC%8F.png" class="" title="openpyxl指定单元格的样式">
<h1 id="xlrd读取excel文件内容"><a href="#xlrd读取excel文件内容" class="headerlink" title="xlrd读取excel文件内容"></a>xlrd读取excel文件内容</h1><img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/xlrd%E8%AF%BB%E5%8F%96excel%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9.png" class="" title="xlrd读取excel文件内容">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd</span><br><span class="line">book = xlrd.open_workbook(<span class="string">&quot;c:\\tmp\\sample.xlsx&quot;</span> ) <span class="comment">#打开指定文件</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> book.sheets(): <span class="comment">#遍历所有的工作表</span></span><br><span class="line">	<span class="built_in">print</span> =(s.name) <span class="comment">#打出工作表名字</span></span><br><span class="line"></span><br><span class="line">sheet1 = book.sheet_by_index(<span class="number">0</span>) <span class="comment">#通过sheet索引获得sheet对象</span></span><br><span class="line">sheet1_name = book.sheet_names()[<span class="number">0</span>] <span class="comment"># 获得指定索引的sheet名称</span></span><br><span class="line"><span class="built_in">print</span>(sheet1_name) <span class="comment">#&gt;&gt;富豪记录</span></span><br><span class="line"></span><br><span class="line">sheet1 = book.sheet_by_name(sheet1_name) <span class="comment">#通过名字获得sheet对象</span></span><br><span class="line">nrows = sheet1.nrows <span class="comment">#总行数</span></span><br><span class="line">ncols = sheet1.ncols <span class="comment">#总列数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows): <span class="comment">#打印表中的内容</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">		cell_value = sheet1.cell_value(i, j)</span><br><span class="line">		<span class="built_in">print</span>(cell_value, end = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>输出：<br>富豪记录<br>学生记录<br>富豪记录<br>姓名 资产（亿）<br>马云 2000.0<br>马化腾 2100.0</p>
<h1 id="xlwt创建excel文件"><a href="#xlwt创建excel文件" class="headerlink" title="xlwt创建excel文件"></a>xlwt创建excel文件</h1><img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/xlwt%E5%88%9B%E5%BB%BAexcel%E6%96%87%E4%BB%B6.png" class="" title="xlwt创建excel文件">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="comment">#创建一个Wordbook对象，即创建一个Excel文件</span></span><br><span class="line">book = xlwt.Workbook(encoding = <span class="string">&quot;utf-8&quot;</span>, style_compression = <span class="number">0</span>)</span><br><span class="line"><span class="comment">#创建一个工作表</span></span><br><span class="line">sheet = book.add_sheet(<span class="string">&quot;成绩单&quot;</span>, cell_overwrite_ok = <span class="literal">True</span>)</span><br><span class="line"><span class="comment">#向表sheet中添加数据</span></span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;姓名&quot;</span>) <span class="comment">#在第0行0列的单元格写入 &quot;姓名&quot;</span></span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&quot;绩点&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&quot;王二&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;3.4&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&quot;赵二&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;3.9&quot;</span>)</span><br><span class="line">sheet = book.add_sheet(<span class="string">&quot;名单&quot;</span>, cell_overwrite_ok = <span class="literal">True</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;学号&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&quot;姓名&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&quot;1234&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&quot;Jack&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">2</span>, <span class="number">0</span>, <span class="string">&quot;6656&quot;</span>)</span><br><span class="line">sheet.write(<span class="number">2</span>, <span class="number">1</span>, <span class="string">&quot;Jone&quot;</span>)</span><br><span class="line">book.save(<span class="string">&quot;c:\\tmp\\sample2.xls&quot;</span>) <span class="comment">#sample2.xls如果本来存在，会被覆盖</span></span><br></pre></td></tr></table></figure>
<h1 id="xlwt向单元格添加公式"><a href="#xlwt向单元格添加公式" class="headerlink" title="xlwt向单元格添加公式"></a>xlwt向单元格添加公式</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line">workbook = xlwt.Workbook()</span><br><span class="line">worksheet = workbook.add_sheet(<span class="string">&#x27;My Sheet&#x27;</span>)</span><br><span class="line">worksheet.write(<span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>) <span class="comment"># Outputs 5</span></span><br><span class="line">worksheet.write(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>) <span class="comment"># Outputs 2</span></span><br><span class="line">worksheet.write(<span class="number">1</span>, <span class="number">0</span>, xlwt.Formula(<span class="string">&#x27;A1*B1&#x27;</span>))</span><br><span class="line"><span class="comment"># Should output &quot;10&quot; (A1[5] * A2[2])</span></span><br><span class="line">worksheet.write(<span class="number">1</span>, <span class="number">1</span>, xlwt.Formula(<span class="string">&#x27;SUM(A1,B1)&#x27;</span>))</span><br><span class="line"><span class="comment"># Should output &quot;7&quot; (A1[5] + A2[2])</span></span><br><span class="line">workbook.save(<span class="string">&#x27;c:\\tmp\\Excel_Workbook.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="xlwt向单元格添加日期"><a href="#xlwt向单元格添加日期" class="headerlink" title="xlwt向单元格添加日期"></a>xlwt向单元格添加日期</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">workbook = xlwt.Workbook()</span><br><span class="line">worksheet = workbook.add_sheet(<span class="string">&#x27;My Sheet&#x27;</span>)</span><br><span class="line">style = xlwt.XFStyle()</span><br><span class="line">style.num_format_str = <span class="string">&#x27;M/D/YY&#x27;</span></span><br><span class="line"><span class="comment"># Other options:</span></span><br><span class="line"><span class="comment">#D-MMM-YY, D-MMM, MMM-YY, h:mm, h:mm:ss,</span></span><br><span class="line"><span class="comment">#h:mm, h:mm:ss, M/D/YY h:mm, mm:ss, [h]:mm:ss, mm:ss.0</span></span><br><span class="line">worksheet.write(<span class="number">0</span>, <span class="number">0</span>, datetime.datetime.now(), style)</span><br><span class="line">workbook.save(<span class="string">&#x27;Excel_Workbook.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="xlwt向单元格添加一个超链接"><a href="#xlwt向单元格添加一个超链接" class="headerlink" title="xlwt向单元格添加一个超链接"></a>xlwt向单元格添加一个超链接</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line">workbook = xlwt.Workbook()</span><br><span class="line">worksheet = workbook.add_sheet(<span class="string">&#x27;My Sheet&#x27;</span>)</span><br><span class="line">worksheet.write(<span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">	xlwt.Formula(<span class="string">&#x27;HYPERLINK(&quot;http://www.pku.edu.cn&quot;;&quot;PKU&quot;)&#x27;</span>))</span><br><span class="line"><span class="comment"># Outputs the text &quot;Google&quot; linking to http://www.google.com</span></span><br><span class="line">workbook.save(<span class="string">&#x27;Excel_Workbook.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h1 id="xlwt合并单元格"><a href="#xlwt合并单元格" class="headerlink" title="xlwt合并单元格"></a>xlwt合并单元格</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line">workbook = xlwt.Workbook()</span><br><span class="line">worksheet = workbook.add_sheet(<span class="string">&#x27;My Sheet&#x27;</span>)</span><br><span class="line">worksheet.write_merge(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;First Merge&#x27;</span>)</span><br><span class="line">worksheet.write(<span class="number">0</span>,<span class="number">4</span>,<span class="string">&quot;ok1&quot;</span>)</span><br><span class="line"><span class="comment"># Merges row 0&#x27;s columns 0 through 3.</span></span><br><span class="line">font = xlwt.Font() <span class="comment"># Create Font</span></span><br><span class="line">font.bold = <span class="literal">True</span> <span class="comment"># Set font to Bold</span></span><br><span class="line">style = xlwt.XFStyle() <span class="comment"># Create Style</span></span><br><span class="line">style.font = font <span class="comment"># Add Bold Font to Style</span></span><br><span class="line">worksheet.write_merge(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;Second Merge&#x27;</span>, style)</span><br><span class="line"><span class="comment"># Merges row 1 through 2&#x27;s columns 0 through 3.</span></span><br><span class="line">worksheet.write(<span class="number">2</span>,<span class="number">4</span>,<span class="string">&quot;ok2&quot;</span>)</span><br><span class="line">workbook.save(<span class="string">&#x27;c:\\tmp\\Excel_Workbook.xls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/xlwt%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC.png" class="" title="xlwt合并单元格"> 
<h1 id="用Pillow处理图像"><a href="#用Pillow处理图像" class="headerlink" title="用Pillow处理图像"></a>用Pillow处理图像</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow</span><br></pre></td></tr></table></figure>
<ul>
<li>图像缩放和旋转</li>
<li>图像加滤镜</li>
<li>图像切割</li>
<li>图像加水印</li>
<li>图像素描化</li>
<li>图像加文字</li>
</ul>
<h2 id="图像的常识"><a href="#图像的常识" class="headerlink" title="图像的常识"></a>图像的常识</h2><ul>
<li><p>图像由像素构成<br>屏幕上每个像素由3个距离非常近的点构成，分别显示红、绿、蓝三种颜色，每个像素可以由一个元组(r,g,b)表示， r,g,b通常是不超过255的整数</p>
</li>
<li><p>图像模式<br>RGB：一个像素有红、绿、蓝三个分量<br>RGBA：一个像素有红、绿、蓝三个分量，以及透明度分量<br>CYMK：一个像素有有青色（Cyan）、洋红色（Magenta）、黄色（Yellow）、黑色(K代表黑)四个分量，即每个像素用元组(c,y,m,k)表示，对应于彩色打印机或者印刷机的4种颜色的墨水。<br>L：黑白图像。每个像素就是一个整数，代表灰度。</p>
</li>
</ul>
<h1 id="图像的缩放"><a href="#图像的缩放" class="headerlink" title="图像的缩放"></a>图像的缩放</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#注意，安装时 pip install pillow</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="comment">#导入Image类进行图像处理</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass.jpg&quot;</span>) <span class="comment">#将图像文件载入对象img</span></span><br><span class="line">w,h = img.size <span class="comment">#获取图像的宽和高（单位:像素),img.size是个元组</span></span><br><span class="line">newSize = (w//<span class="number">2</span>,h//<span class="number">2</span>) <span class="comment">#生成一个新的图像尺寸</span></span><br><span class="line">newImg = img.resize(newSize) <span class="comment">#得到一张原图像一半大小的新图像</span></span><br><span class="line"></span><br><span class="line">newImg.save(<span class="string">&quot;c:/tmp/pic/grass_half.jpg&quot;</span>) <span class="comment">#保存新图像文件</span></span><br><span class="line"></span><br><span class="line">newImg.thumbnail((<span class="number">128</span>,<span class="number">128</span>)) <span class="comment">#变成宽高各128像素的缩略图</span></span><br><span class="line">newImg.save(<span class="string">&quot;c:/tmp/pic/grass_thumb.png&quot;</span>, <span class="string">&quot;PNG&quot;</span>)</span><br><span class="line"><span class="comment">#保存新图像文件为png文件</span></span><br><span class="line">newImg.show() <span class="comment">#显示图像文件</span></span><br></pre></td></tr></table></figure>
<h1 id="图像的旋转、翻转图像、-和滤镜效果"><a href="#图像的旋转、翻转图像、-和滤镜效果" class="headerlink" title="图像的旋转、翻转图像、 和滤镜效果"></a>图像的旋转、翻转图像、 和滤镜效果</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFilter <span class="comment">#实现滤镜效果需要</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass_half.jpg&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(img.<span class="built_in">format</span>, img.mode) <span class="comment">#&gt;&gt;JPEG RGB</span></span><br><span class="line"></span><br><span class="line">newImg = img.rotate(<span class="number">90</span>, expand = <span class="literal">True</span>) <span class="comment">#图像逆时针旋转90度</span></span><br><span class="line">newImg.show()</span><br><span class="line">newImg = img.transpose(Image.FLIP_LEFT_RIGHT) <span class="comment">#左右翻转</span></span><br><span class="line">newImg = img.transpose(Image.FLIP_TOP_BOTTOM) <span class="comment">#上下翻转(颠倒)</span></span><br><span class="line">newImg = img.<span class="built_in">filter</span>(ImageFilter.BLUR) <span class="comment">#模糊效果</span></span><br></pre></td></tr></table></figure>
<p>滤镜效果：<br>ImageFilter.CONTOUR 轮廓效果<br>ImageFilter.EDGE_ENHANCE 边缘增强<br>ImageFilter.EMBOSS 浮雕<br>ImageFilter.SMOOTH 平滑<br>ImageFilter.SHARPEN 锐化</p>
<h1 id="图像的裁剪"><a href="#图像的裁剪" class="headerlink" title="图像的裁剪"></a>图像的裁剪</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/grass.jpg&quot;</span>)</span><br><span class="line">w,h = img.size[<span class="number">0</span>]//<span class="number">3</span>,img.size[<span class="number">1</span>]//<span class="number">3</span></span><br><span class="line">gap = <span class="number">10</span> <span class="comment">#九宫图中相邻两幅子图间的空白宽10像素</span></span><br><span class="line">newImg = Image.new(<span class="string">&quot;RGB&quot;</span>,(w * <span class="number">3</span> + gap * <span class="number">2</span>, h * <span class="number">3</span> + gap * <span class="number">2</span>),<span class="string">&quot;white&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>):</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>):</span><br><span class="line">		clipImg = img.crop((j*w,i*h,(j+<span class="number">1</span>)*w,(i+<span class="number">1</span>)*h))</span><br><span class="line">		<span class="comment">#crop((左上角横坐标，左上角纵坐标，右下角横坐标，右下角纵坐标))</span></span><br><span class="line">		clipImg.save(<span class="string">&quot;c:/tmp/pic/grass%d%d.jpg&quot;</span> % (i,j))</span><br><span class="line">		newImg.paste(clipImg,(j*(w + gap), i * ( h + gap)))</span><br><span class="line">newImg.save(<span class="string">&quot;c:/tmp/pic/grass9.jpg&quot;</span>) <span class="comment">#保存九宫图</span></span><br><span class="line">newImg.show()</span><br></pre></td></tr></table></figure>
<img src="/2023/01/30/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E7%AB%A0%E7%8E%A9%E8%BD%ACPython%E7%94%9F%E6%80%81/%E5%9B%BE%E5%83%8F%E7%9A%84%E8%A3%81%E5%89%AA.png" class="" title="图像的裁剪"> 
<h1 id="图像的素描化"><a href="#图像的素描化" class="headerlink" title="图像的素描化"></a>图像的素描化</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeSketch</span>(<span class="params">img, threshold</span>):</span><br><span class="line">	w, h = img.size</span><br><span class="line">	img = img.convert(<span class="string">&#x27;L&#x27;</span>) <span class="comment">#图像转换成灰度模式</span></span><br><span class="line">	pix = img.load() <span class="comment">#获取像素矩阵</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w-<span class="number">1</span>):</span><br><span class="line">		<span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h-<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">abs</span>(pix[x,y] - pix[x+<span class="number">1</span>,y+<span class="number">1</span>]) &gt;= threshold:</span><br><span class="line">				pix[x,y] = <span class="number">0</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pix[x,y] = <span class="number">255</span></span><br><span class="line">	<span class="keyword">return</span> img</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/models2.jpg&quot;</span>)</span><br><span class="line">img = makeSketch(img, <span class="number">15</span>) <span class="comment">#阈值threshold为15</span></span><br><span class="line">img.show()</span><br></pre></td></tr></table></figure>
<h1 id="给图像添加水印"><a href="#给图像添加水印" class="headerlink" title="给图像添加水印"></a>给图像添加水印</h1><ul>
<li>原理： paste时可以用“掩膜”指定img的每个像素粘贴过去的透明度。如果透明度为0，则完全透明，如果透明度为255，则完全遮盖imgSrc原来的像素。</li>
<li>mask参数即为掩膜，是个模式为”L”的图片(Image对象)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imgSrc.paste(img, (x, y), mask = msk)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getMask</span>(<span class="params">img,isTransparent,alpha</span>):	<span class="comment">#（图像，什么像素是透明，其他像素的透明度）</span></span><br><span class="line"><span class="comment"># 返回由img变出来的掩膜</span></span><br><span class="line">	<span class="keyword">if</span> img.mode != <span class="string">&quot;RGBA&quot;</span>:</span><br><span class="line">		img = img.convert(<span class="string">&#x27;RGBA&#x27;</span>) <span class="comment">#转换成RGBA模式的图像</span></span><br><span class="line">	w, h = img.size</span><br><span class="line">	pixels = img.load() <span class="comment">#获取像素矩阵</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">		<span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">			p = pixels[x,y] <span class="comment">#p是一个四元素元组(r,g,b,a)</span></span><br><span class="line">			<span class="keyword">if</span> isTransparent(p[<span class="number">0</span>],p[<span class="number">1</span>],p[<span class="number">2</span>]): <span class="comment">#判断p是否应该变成透明像素</span></span><br><span class="line">			<span class="comment">#p[0],p[1],p[2] 分别是红、绿、蓝分量</span></span><br><span class="line">				pixels[x,y] = (p[<span class="number">0</span>],p[<span class="number">1</span>],p[<span class="number">2</span>],<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				pixels[x,y] = (p[<span class="number">0</span>],p[<span class="number">1</span>],p[<span class="number">2</span>],alpha)</span><br><span class="line">	r, g, b, a = img.split() <span class="comment"># 分离出img中的四个分量,a就是掩膜</span></span><br><span class="line">	<span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/pku.png&quot;</span>)</span><br><span class="line">msk = getMask(img, <span class="keyword">lambda</span> r,g,b: r &gt;<span class="number">245</span> <span class="keyword">and</span> g &gt; <span class="number">245</span> <span class="keyword">and</span> b &gt; <span class="number">245</span>, <span class="number">130</span>)</span><br><span class="line">imgSrc = Image.<span class="built_in">open</span>(<span class="string">&quot;c:/tmp/pic/iceland1.png&quot;</span>)</span><br><span class="line">imgSrc.paste(img,(imgSrc.size[<span class="number">0</span>] - img.size[<span class="number">0</span>] - <span class="number">30</span> , imgSrc.size[<span class="number">1</span>] - img.size[<span class="number">1</span>] - <span class="number">30</span>),mask = msk)</span><br><span class="line"><span class="comment">#粘贴透明图像img到imgSrc的右下角，用a做掩膜</span></span><br><span class="line">imgSrc.show()</span><br></pre></td></tr></table></figure>
<h1 id="在图像上绘图和写字"><a href="#在图像上绘图和写字" class="headerlink" title="在图像上绘图和写字"></a>在图像上绘图和写字</h1><p>照片的exif信息，存有照片的所有信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont, ExifTags </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">correctOrientation</span>(<span class="params">img</span>):</span><br><span class="line"><span class="comment">#根据exif判断,img里的图像如有颠倒或旋转则生成一幅将其摆正的图返回</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">hasattr</span>(img, <span class="string">&quot;_getexif&quot;</span>): <span class="comment">#判断img有没有_ getexif函数</span></span><br><span class="line">		exif = img._getexif()	<span class="comment">#获取图像exi f信息,返回值是个字典</span></span><br><span class="line">		<span class="keyword">if</span> exif != <span class="literal">None</span>:</span><br><span class="line">			orientation = exif[getExifKeyCode(<span class="string">&#x27;Orientation&#x27;</span>)]</span><br><span class="line">			<span class="keyword">if</span> orientation == <span class="number">3</span>:	<span class="comment">#手机顶部朝右拍</span></span><br><span class="line">				img = img.rotate(<span class="number">180</span>, expand=<span class="literal">True</span>)</span><br><span class="line">			<span class="keyword">elif</span> orientation == <span class="number">6</span>:	<span class="comment">#手机正常竖着拍(顶部朝上)</span></span><br><span class="line">				img = img.rotate(<span class="number">270</span>, expand=<span class="literal">True</span>)</span><br><span class="line">			<span class="keyword">elif</span> orientation == <span class="number">8</span>:	<span class="comment">#手机顶部朝下拍</span></span><br><span class="line">				img = img.rotate(<span class="number">90</span>, expand=<span class="literal">True</span>)</span><br><span class="line">	<span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getExifKeyCode</span>(<span class="params">keyStr</span>):	<span class="comment">#根据属性名称字符串求属性代号</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> ExifTags.TAGS.items():</span><br><span class="line">		<span class="keyword">if</span> x[<span class="number">1</span>] == keyStr:</span><br><span class="line">			<span class="keyword">return</span> x[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeTextToImage</span>(<span class="params">img, text, myFont</span>):</span><br><span class="line">	<span class="comment">#在img中以字体myFont在右下角写入字符串text</span></span><br><span class="line">	<span class="comment">#会改变img中的图像</span></span><br><span class="line">	W, h = img.size</span><br><span class="line">	fw, fh = myFont.getsize(text) <span class="comment">#求text显示出来的高度, 宽度</span></span><br><span class="line">	draw = ImageDraw.Draw(img) <span class="comment">#以后就可以通过draw在img, 上画图、写字</span></span><br><span class="line">	x,y = w - fw - <span class="number">30</span>, h - fh - <span class="number">30</span>	<span class="comment">#计算text的左上角的位置</span></span><br><span class="line">	draw.rectangle((x - <span class="number">5</span>, y - <span class="number">5</span>, x + fw + <span class="number">5</span>, y + fh + <span class="number">5</span>), outline= <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">	draw.text((x ,y), text, (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>), font=myFont)</span><br></pre></td></tr></table></figure></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">HibisciDai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://hibiscidai.com/2023/01/30/实用Python程序设计MOOC-第十章玩转Python生态/">http://hibiscidai.com/2023/01/30/实用Python程序设计MOOC-第十章玩转Python生态/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hibiscidai.com">HibisciDai</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/PythonMOOC/">PythonMOOC</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/zhifubaodashang.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="/img/weixin.png"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share pull-right" data-disabled="linkedin,diandian"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2023/02/01/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%92%8C%E5%B1%95%E7%A4%BA/"><i class="fa fa-chevron-left">  </i><span>实用Python程序设计MOOC-第十一章数据分析和展示</span></a></div><div class="next-post pull-right"><a href="/2023/01/14/%E5%AE%9E%E7%94%A8Python%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1MOOC-%E6%9C%9F%E6%9C%AB%E8%80%83%E8%AF%95/"><span>实用Python程序设计MOOC-期末考试</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="lv-container" data-id="city" data-uid="MTAyMC8zNTQ2NC8xMjAwMA=="><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
})(document, 'script');</script></div></div></div><footer class="footer-bg" style="background-image: url(/img/banner2.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2023 By HibisciDai</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" data-click="false"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>